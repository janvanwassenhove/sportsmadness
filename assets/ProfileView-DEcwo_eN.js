import{e as P,r as p,o as _,g as a,i as t,P as C,l as b,u as y,n as V,t as d,F as E,k as M,j as u,G as f,z as v,I as U,E as F,h as r}from"./vendor-BHPTlv71.js";import{u as S,s as x}from"./index-BEMb2HgI.js";const T={class:"container mx-auto px-4 py-8 max-w-2xl"},A={class:"bg-white rounded-lg shadow-lg p-6"},B={class:"flex items-center mb-6"},$={key:0,class:"flex justify-center items-center py-12"},D={class:"bg-gray-50 rounded-lg p-4"},j={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},G=["value"],I={class:"flex items-center"},L={key:0,class:"bg-blue-50 rounded-lg p-4"},z={class:"flex items-center space-x-3"},R={class:"font-medium text-gray-900"},q={class:"text-sm text-gray-600"},O={key:0,class:"mt-4"},H={class:"bg-white rounded border p-3 max-h-32 overflow-y-auto"},J={key:0,class:"text-gray-500 ml-2"},K={class:"bg-white border rounded-lg p-4"},Q={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},W={class:"mt-4"},X={class:"flex justify-end space-x-3 pt-4 border-t"},Y=["disabled"],oe=P({__name:"ProfileView",setup(Z){const n=S(),g=p(!0),m=p(!1),i=p(null),s=p({firstName:"",lastName:"",position:"",phone:"",bio:""});async function w(){if(n.profile?.assigned_team_id)try{const{data:o,error:e}=await x.from("teams").select("*").eq("id",n.profile.assigned_team_id).single();if(e)throw e;i.value=o}catch(o){console.error("Error loading assigned team:",o)}}async function h(){try{g.value=!0;const o=n.user;o?.user_metadata&&(s.value={firstName:o.user_metadata.firstName||"",lastName:o.user_metadata.lastName||"",position:o.user_metadata.position||"",phone:o.user_metadata.phone||"",bio:o.user_metadata.bio||""})}catch(o){console.error("Error loading profile:",o)}finally{g.value=!1}}async function k(){try{m.value=!0;const{error:o}=await x.auth.updateUser({data:{firstName:s.value.firstName,lastName:s.value.lastName,position:s.value.position,phone:s.value.phone,bio:s.value.bio}});if(o)throw o;alert("Profile updated successfully!")}catch(o){console.error("Error updating profile:",o),alert(`Failed to update profile: ${o.message}`)}finally{m.value=!1}}function N(o){switch(o){case"admin":return"bg-red-100 text-red-800";case"team":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}}return _(async()=>{await Promise.all([h(),w()])}),(o,e)=>(r(),a("div",T,[t("div",A,[t("div",B,[t("button",{onClick:e[0]||(e[0]=l=>o.$router.go(-1)),class:"mr-4 text-gray-600 hover:text-gray-800"}," â† Back "),e[7]||(e[7]=t("h1",{class:"text-3xl font-bold text-gray-800"},"My Profile",-1))]),g.value?(r(),a("div",$,[...e[8]||(e[8]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),t("span",{class:"ml-2 text-gray-600"},"Loading profile...",-1)])])):(r(),a("form",{key:1,onSubmit:C(k,["prevent"]),class:"space-y-6"},[t("div",D,[e[11]||(e[11]=t("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Account Information",-1)),t("div",j,[t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email",-1)),t("input",{value:y(n).profile?.email,type:"email",readonly:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100"},null,8,G)]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Role",-1)),t("div",I,[t("span",{class:V(["inline-flex px-3 py-1 text-sm font-semibold rounded-full",N(y(n).profile?.role)])},d(y(n).profile?.role),3)])])])]),i.value?(r(),a("div",L,[e[14]||(e[14]=t("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Team Assignment",-1)),t("div",z,[e[12]||(e[12]=t("div",{class:"text-2xl"},"ðŸ‘¥",-1)),t("div",null,[t("div",R,d(i.value.name),1),t("div",q,d(i.value.players?.length||0)+" players",1)])]),i.value.players?.length?(r(),a("div",O,[e[13]||(e[13]=t("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Team Members",-1)),t("div",H,[(r(!0),a(E,null,M(i.value.players,(l,c)=>(r(),a("div",{key:c,class:"text-sm text-gray-800 py-1"},[v(d(l.name||`Player ${c+1}`)+" ",1),l.position?(r(),a("span",J,"("+d(l.position)+")",1)):b("",!0)]))),128))])])):b("",!0)])):b("",!0),t("div",K,[e[21]||(e[21]=t("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Personal Information",-1)),t("div",Q,[t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"First Name",-1)),u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>s.value.firstName=l),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your first name"},null,512),[[f,s.value.firstName]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Last Name",-1)),u(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.lastName=l),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your last name"},null,512),[[f,s.value.lastName]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[v(" Position "),t("span",{class:"text-xs text-gray-500"},"(Optional)")],-1)),u(t("select",{"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.position=l),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[17]||(e[17]=[F('<option value="">Select position</option><option value="Goalkeeper">Goalkeeper</option><option value="Defender">Defender</option><option value="Midfielder">Midfielder</option><option value="Forward">Forward</option><option value="Coach">Coach</option><option value="Assistant Coach">Assistant Coach</option>',7)])],512),[[U,s.value.position]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number",-1)),u(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.phone=l),type:"tel",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your phone number"},null,512),[[f,s.value.phone]])])]),t("div",W,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Bio",-1)),u(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=l=>s.value.bio=l),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Tell us about yourself..."},null,512),[[f,s.value.bio]])])]),t("div",X,[t("button",{type:"button",onClick:e[6]||(e[6]=l=>o.$router.push("/")),class:"px-6 py-2 text-gray-600 hover:text-gray-800"}," Cancel "),t("button",{type:"submit",disabled:m.value,class:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed"},d(m.value?"Updating...":"Update Profile"),9,Y)])],32))])]))}});export{oe as default};
