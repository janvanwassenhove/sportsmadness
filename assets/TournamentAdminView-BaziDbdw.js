import{e as st,r as C,D as Y,a as rt,w as nt,o as ot,T as it,g as u,i as t,l as v,x as at,y as lt,u as ut,O as dt,F as S,k as V,t as m,n as j,P as Q,j as f,G as g,I as J,z as mt,q as ct,h as d}from"./vendor-BHPTlv71.js";import{s as x,_ as bt}from"./index-BEMb2HgI.js";const _t={class:"min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-pink-900 p-4"},pt={class:"container mx-auto"},ft={class:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20 mb-8"},ht={class:"flex justify-between items-center mb-6"},vt={class:"flex space-x-3"},gt={key:0,class:"grid md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6"},xt=["onClick"],wt={class:"text-lg font-bold text-white mb-2"},yt={class:"text-sm text-blue-200 space-y-1"},kt={key:0},qt={class:"capitalize"},Tt=["onClick"],Dt={key:1,class:"text-center py-8"},Mt={key:0,class:"space-y-8"},Et={class:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20"},Ct={class:"flex justify-between items-center mb-4"},St={class:"text-2xl font-bold text-white"},Pt={class:"flex space-x-2"},$t={class:"grid md:grid-cols-3 gap-4 text-sm"},Bt={class:"text-white font-semibold"},Ut={key:0},Vt={class:"text-white font-semibold"},Ft={class:"capitalize"},Gt={key:0,class:"mt-4"},At={class:"text-white mt-1"},It={class:"mt-4 p-4 bg-white/5 rounded-lg border border-white/10"},Nt={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-4"},jt={class:"text-white font-semibold"},Ht={class:"text-white font-semibold"},Ot={class:"text-white font-semibold"},Qt={class:"text-white font-semibold"},zt={class:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm border-t border-white/10 pt-3"},Lt={class:"text-white font-semibold"},Rt={class:"text-white font-semibold"},Wt={class:"text-white font-semibold"},Kt={class:"text-xs text-white/60 mt-2"},Yt={class:"mt-3 p-3 bg-white/5 rounded border border-white/5"},Jt={class:"flex justify-between items-center mb-2"},Xt={class:"text-xs text-white/60"},Zt={class:"space-y-2"},es={class:"text-white/80 font-semibold mb-1"},ts={class:"grid grid-cols-2 gap-2 ml-2"},ss={key:0,class:"text-white/40 col-span-2"},rs={key:0,class:"text-xs text-white/40 text-center pt-1"},ns={class:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20"},os={class:"flex justify-between items-center mb-6"},is=["disabled"],as={key:0,class:"space-y-4"},ls={class:"flex justify-between items-center mb-4"},us={class:"flex items-center space-x-4"},ds={class:"text-lg font-bold text-white"},ms={class:"flex space-x-2"},cs=["onClick"],bs=["onClick"],_s={key:0,class:"space-y-2"},ps={class:"grid grid-cols-2 md:grid-cols-4 gap-2"},fs={class:"text-white font-semibold"},hs={class:"text-xs text-blue-200"},vs={key:1,class:"text-sm text-blue-200"},gs={class:"mt-4 border-t border-white/10 pt-3"},xs={class:"flex justify-between items-center mb-3"},ws={class:"flex space-x-2"},ys=["onClick"],ks=["onClick"],qs=["onClick"],Ts=["onClick"],Ds={key:0,class:"space-y-2"},Ms={class:"flex justify-between items-center"},Es={class:"flex items-center space-x-4"},Cs={class:"text-blue-200 font-mono"},Ss={class:"text-white"},Ps={class:"flex items-center space-x-2"},$s={class:"text-xs text-white/60"},Bs=["onClick"],Us=["onClick"],Vs={key:0,class:"text-xs text-blue-200 text-center py-2"},Fs={key:1,class:"text-xs text-white/60 text-center py-3"},Gs={key:1,class:"text-center py-8"},As={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50"},Is={class:"bg-gray-900 rounded-xl p-6 border border-white/20 max-w-md w-full mx-4"},Ns={class:"border border-white/20 rounded-lg p-4"},js={class:"grid grid-cols-2 gap-3"},Hs={class:"block text-blue-200 text-xs font-semibold mb-1"},Os={class:"block text-blue-200 text-xs font-semibold mb-1"},Qs={key:0},zs={key:1},Ls={class:"block text-blue-200 text-xs font-semibold mb-1"},Rs={class:"text-xs text-white/60 mt-2"},Ws={class:"border border-white/20 rounded-lg p-4"},Ks={class:"grid grid-cols-2 gap-3"},Ys={class:"text-xs text-white/60 mt-2"},Js={class:"flex space-x-3 pt-4"},Xs={key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50"},Zs={class:"bg-gray-900 rounded-xl p-6 border border-white/20 max-w-md w-full mx-4"},er={key:0,class:"space-y-3"},tr={class:"flex space-x-3 pt-4"},sr={key:2,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50"},rr={class:"bg-gray-900 rounded-xl p-6 border border-white/20 max-w-md w-full mx-4"},nr={class:"border border-white/20 rounded-lg p-4"},or={class:"grid grid-cols-2 gap-3"},ir={class:"block text-blue-200 text-xs font-semibold mb-1"},ar={class:"block text-blue-200 text-xs font-semibold mb-1"},lr={key:0},ur={key:1},dr={class:"border border-white/20 rounded-lg p-4"},mr={class:"grid grid-cols-2 gap-3"},cr={class:"flex space-x-3 pt-4"},br={key:3,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50"},_r={class:"bg-gray-900 rounded-xl p-6 border border-white/20 max-w-md w-full mx-4"},pr={class:"border border-white/20 rounded-lg p-4"},fr={class:"grid grid-cols-2 gap-3"},hr={class:"block text-blue-200 text-xs font-semibold mb-1"},vr={class:"block text-blue-200 text-xs font-semibold mb-1"},gr={key:0},xr={key:1},wr={class:"block text-blue-200 text-xs font-semibold mb-1"},yr={class:"text-xs text-white/60 mt-2"},kr={class:"flex space-x-3 pt-4"},qr={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50"},Tr={class:"bg-gray-900 rounded-xl p-6 border border-white/20 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"},Dr=["value"],Mr={key:0},Er=["value"],Cr={class:"grid grid-cols-2 gap-4"},Sr=["label"],Pr=["value","disabled"],$r=["label"],Br=["value","disabled"],Ur={key:1,class:"bg-purple-900/20 border border-purple-500/30 rounded-lg p-3"},Vr={class:"border border-white/20 rounded-lg p-4"},Fr={class:"grid grid-cols-2 gap-3"},Gr={class:"block text-blue-200 text-xs font-semibold mb-1"},Ar={class:"block text-blue-200 text-xs font-semibold mb-1"},Ir={key:0},Nr={key:1},jr={class:"block text-blue-200 text-xs font-semibold mb-1"},Hr={class:"text-xs text-white/60 mt-2"},Or={key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4"},Qr={class:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20 w-full max-w-4xl max-h-[90vh] overflow-y-auto"},zr={class:"flex justify-between items-center mb-6"},Lr={class:"text-xl font-bold text-white"},Rr={class:"space-y-6"},Wr={key:0},Kr={class:"grid gap-4"},Yr={class:"text-white font-semibold mb-3"},Jr={class:"space-y-2"},Xr={class:"text-white"},Zr={class:"flex space-x-2"},en=["onClick"],tn={class:"text-lg font-semibold text-white mb-4"},sn={class:"grid grid-cols-2 gap-4 mb-4"},rn={class:"text-white font-semibold"},nn={class:"text-blue-200 text-sm"},on=["onClick"],an={class:"grid grid-cols-2 gap-2 max-h-40 overflow-y-auto bg-white/5 rounded p-3"},ln=["value","checked","onChange"],un={class:"flex justify-end space-x-4 mt-6"},dn=["disabled"],mn=st({__name:"TournamentAdminView",setup(cn){const ce=ct(),F=C([]),o=C(null),k=C([]),A=C({}),I=C([]),ae=C([]),z=C([]),$=C({}),ke=C(!0),L=C(!1),X=C(!1),Z=C(!1),ee=C(!1),le=C(!1),ue=C(!1),R=C(null),te=C([]),B=C([]),p=Y({name:"",start_date:"",end_date:"",description:"",quarters_count:4,quarter_duration_minutes:15,break_duration_minutes:2,halftime_duration_minutes:10,tournament_start_time:"09:00",match_gap_minutes:15}),T=Y({name:"",type:"",numGroups:2,teamsPerGroup:4}),_=Y({id:"",name:"",start_date:"",end_date:"",description:"",quarters_count:4,quarter_duration_minutes:15,break_duration_minutes:2,halftime_duration_minutes:10,tournament_start_time:"09:00",match_gap_minutes:15}),h=Y({id:"",quarters_count:4,quarter_duration_minutes:15,break_duration_minutes:2,halftime_duration_minutes:10,start_time:"09:00"}),a=Y({division_id:"",group_id:"",team_a:"",team_b:"",start_time:"09:00",quarters_count:4,quarter_duration_minutes:15,break_duration_minutes:2,halftime_duration_minutes:10}),se=rt(()=>{const r=[];if(r.push({id:"divider-actual",name:"--- Actual Teams ---",divider:!0}),I.value.forEach(e=>{r.push({id:e.id,name:e.name,isPlaceholder:!1})}),a.division_id&&k.value.length>0){const e=k.value.findIndex(s=>s.id===a.division_id);if(e>0)for(let s=e-1;s>=0;s--){const n=k.value[s];n&&n.type==="group"&&(r.push({id:`divider-placeholder-${s}`,name:`--- Team Positions from ${n.name} ---`,divider:!0}),(A.value[n.id]||[]).forEach(l=>{for(let b=1;b<=4;b++){const c=xe(b);r.push({id:`${l.id}_position_${b}`,name:`${b}${c} from ${l.name}`,isPlaceholder:!0})}}))}}return r});nt(()=>a.division_id,(r,e)=>{e&&r!==e&&(a.team_a="",a.team_b="",a.group_id="")});async function qe(){try{const{data:r,error:e}=await x.from("tournaments").select("*").order("created_at",{ascending:!1});if(e){console.error("Error loading tournaments:",e);return}F.value=r||[]}catch(r){console.error("Error:",r)}}async function Te(){try{const{data:r,error:e}=await x.from("teams").select("*").order("name");if(e){console.error("Error loading teams:",e);return}I.value=r||[]}catch(r){console.error("Error:",r)}}async function W(r){try{const{data:e,error:s}=await x.from("tournament_divisions").select("*").eq("tournament_id",r).order("order_index");if(s){console.error("Error loading divisions:",s);return}k.value=e||[];const n={};for(const c of k.value){const{data:w,error:M}=await x.from("tournament_groups").select("*").eq("division_id",c.id).order("order_index");!M&&w&&(n[c.id]=w)}A.value=n;const i={};for(const c of k.value){const{data:w,error:M}=await x.from("matches").select("*").eq("tournament_id",r).order("created_at");!M&&w&&(i[c.id]=w.filter(E=>E.division_id===c.id||!E.division_id))}$.value=i;const{data:l,error:b}=await x.from("tournament_team_participations").select("*").eq("tournament_id",r);!b&&l&&(ae.value=l)}catch(e){console.error("Error loading tournament data:",e)}}async function De(r){o.value=r,await W(r.id)}async function be(){o.value&&await W(o.value.id)}function _e(){const r=p.quarters_count||4,e=p.quarter_duration_minutes||15,s=p.break_duration_minutes||2,n=p.halftime_duration_minutes||10,i=r*e;let l=0;return r===1?l=0:r===2?l=n:r>2&&(l=(r-1-1)*s+n),i+l}function de(){if(!o.value)return 0;const r=o.value.quarters_count||4,e=o.value.quarter_duration_minutes||15,s=o.value.break_duration_minutes||2,n=o.value.halftime_duration_minutes||10,i=r*e;let l=0;return r===1?l=0:r===2?l=n:r>2&&(l=(r-1-1)*s+n),i+l}function N(r){return r?r.substring(0,5):null}function Me(r,e){const s=[],n=r.tournament_start_time||"09:00:00",i=Ee(r),l=r.match_gap_minutes||15,b=i+l,c=n.substring(0,5).split(":").map(Number),w=c[0]||9,M=c[1]||0;let E=w*60+M;for(let q=0;q<e;q++){const D=E%1440,y=Math.floor(D/60),U=D%60;s.push(`${y.toString().padStart(2,"0")}:${U.toString().padStart(2,"0")}:00`),E+=b}return s}function Ee(r){const e=r.quarters_count||4,s=r.quarter_duration_minutes||15,n=r.break_duration_minutes||2,i=r.halftime_duration_minutes||10,l=e*s;let b=0;return e===1?b=0:e===2?b=i:e>2&&(b=(e-1-1)*n+i),l+b}async function Ce(){try{const r={name:p.name,start_date:p.start_date,end_date:p.end_date||null,description:p.description||null,quarters_count:p.quarters_count,quarter_duration_minutes:p.quarter_duration_minutes,break_duration_minutes:p.break_duration_minutes,halftime_duration_minutes:p.halftime_duration_minutes,tournament_start_time:p.tournament_start_time+":00",match_gap_minutes:p.match_gap_minutes},{data:e,error:s}=await x.from("tournaments").insert([r]).select().single();if(s){console.error("Error creating tournament:",s);return}F.value.unshift(e),o.value=e,L.value=!1,he()}catch(r){console.error("Error:",r)}}async function Se(){if(o.value)try{const r={tournament_id:o.value.id,name:T.name,type:T.type,order_index:k.value.length,phase_order:k.value.length,settings:T.type==="group"?{num_groups:T.numGroups,teams_per_group:T.teamsPerGroup}:{}},{data:e,error:s}=await x.from("tournament_divisions").insert([r]).select().single();if(s){console.error("Error creating division:",s);return}if(k.value.push(e),T.type==="group"){const n=[];for(let b=0;b<T.numGroups;b++){const c=String.fromCharCode(65+b);n.push({division_id:e.id,name:`Group ${c}`,order_index:b})}const{data:i,error:l}=await x.from("tournament_groups").insert(n).select();!l&&i&&(A.value[e.id]=i)}X.value=!1,ve()}catch(r){console.error("Error:",r)}}async function Pe(){if(o.value)try{const{error:r}=await x.from("tournaments").update({name:_.name,start_date:_.start_date,end_date:_.end_date||null,description:_.description||null,quarters_count:_.quarters_count,quarter_duration_minutes:_.quarter_duration_minutes,break_duration_minutes:_.break_duration_minutes,halftime_duration_minutes:_.halftime_duration_minutes,tournament_start_time:_.tournament_start_time+":00",match_gap_minutes:_.match_gap_minutes}).eq("id",_.id);if(r){console.error("Error updating tournament:",r);return}o.value={...o.value,name:_.name,start_date:_.start_date,end_date:_.end_date,description:_.description,quarters_count:_.quarters_count,quarter_duration_minutes:_.quarter_duration_minutes,break_duration_minutes:_.break_duration_minutes,halftime_duration_minutes:_.halftime_duration_minutes,tournament_start_time:_.tournament_start_time+":00",match_gap_minutes:_.match_gap_minutes};const e=F.value.findIndex(n=>n.id===_.id);e!==-1&&(F.value[e]={...o.value}),Z.value=!1,confirm(`Tournament timing settings have been updated. Do you want to recalculate all match start times?

This will update the scheduled start times for all matches based on the new settings.
Choose "OK" to update schedules or "Cancel" to keep existing times.`)&&await $e()}catch(r){console.error("Error:",r)}}async function $e(){if(o.value)try{console.log("Updating match schedules for tournament:",o.value.name);const{data:r,error:e}=await x.from("matches").select("id, division_id, tournament_id").eq("tournament_id",o.value.id).order("division_id").order("id");if(e){console.error("Error fetching matches for schedule update:",e),alert("Failed to load matches for schedule update. Please try again.");return}if(!r||r.length===0){console.log("No matches found to update");return}console.log(`Found ${r.length} matches to update`);const s=new Map;r.forEach(i=>{s.has(i.division_id)||s.set(i.division_id,[]),s.get(i.division_id).push(i)});const n=[];for(const[i,l]of s){const b=k.value.find(c=>c.id===i);b&&l.forEach((c,w)=>{const M=O(b,w);n.push({id:c.id,start_time:M})})}if(n.length>0){let i=0;for(const l of n){const{error:b}=await x.from("matches").update({start_time:l.start_time}).eq("id",l.id);b?console.error(`Error updating match ${l.id} start time:`,b):i++}console.log(`Successfully updated start times for ${i}/${n.length} matches`),i>0?(await W(o.value.id),alert(`Successfully updated start times for ${i} matches!`)):alert("Failed to update match schedules. Please try again.")}}catch(r){console.error("Error updating match schedules:",r),alert("An error occurred while updating match schedules. Please try again.")}}async function Be(){if(o.value)try{const{error:r}=await x.from("tournaments").update({status:"active"}).eq("id",o.value.id);if(r){console.error("Error starting tournament:",r);return}o.value.status="active";const e=F.value.findIndex(s=>s.id===o.value.id);e!==-1&&F.value[e]&&(F.value[e].status="active")}catch(r){console.error("Error:",r)}}async function Ue(r){if(confirm("Are you sure you want to delete this division? This will remove all groups and matches associated with it."))try{const{error:e}=await x.from("tournament_divisions").delete().eq("id",r);if(e){console.error("Error deleting division:",e);return}k.value=k.value.filter(s=>s.id!==r),delete A.value[r]}catch(e){console.error("Error:",e)}}function Ve(r){const e=o.value?.quarters_count||4,s=o.value?.quarter_duration_minutes||15,n=o.value?.break_duration_minutes||2,i=o.value?.halftime_duration_minutes||10,l=o.value?.tournament_start_time||"09:00:00";h.id=r.id,h.quarters_count=r.quarters_count||e,h.quarter_duration_minutes=r.quarter_duration_minutes||s,h.break_duration_minutes=r.break_duration_minutes||n,h.halftime_duration_minutes=r.halftime_duration_minutes||i,h.start_time=N(r.start_time)||N(l)||"09:00",ee.value=!0}async function Fe(){try{const r=h.start_time+":00",{error:e}=await x.from("matches").update({quarters_count:h.quarters_count,quarter_duration_minutes:h.quarter_duration_minutes,break_duration_minutes:h.break_duration_minutes,halftime_duration_minutes:h.halftime_duration_minutes,start_time:r}).eq("id",h.id);if(e){console.error("Error updating match settings:",e),alert("Failed to save match settings. Please try again.");return}const s=n=>{const i=n.findIndex(l=>l.id===h.id);if(i!==-1&&n[i]){const l=n[i];l.quarters_count=h.quarters_count,l.quarter_duration_minutes=h.quarter_duration_minutes,l.break_duration_minutes=h.break_duration_minutes,l.halftime_duration_minutes=h.halftime_duration_minutes,l.start_time=r}};s(z.value);for(const n in $.value)$.value[n]&&s($.value[n]);ee.value=!1,console.log("âœ… Match settings saved successfully")}catch(r){console.error("Error saving match settings:",r),alert("Failed to save match settings. Please try again.")}}async function Ge(r){if(confirm("Are you sure you want to delete this match? This action cannot be undone."))try{const{error:e}=await x.from("matches").delete().eq("id",r);if(e){console.error("Error deleting match:",e),alert("Failed to delete match. Please try again.");return}z.value=z.value.filter(s=>s.id!==r);for(const s in $.value){const n=$.value[s];n&&($.value[s]=n.filter(i=>i.id!==r))}console.log("âœ… Match deleted successfully")}catch(e){console.error("Error:",e),alert("Failed to delete match. Please try again.")}}function Ae(r){if(!o.value)return;const e=o.value.quarters_count||4,s=o.value.quarter_duration_minutes||15,n=o.value.break_duration_minutes||2,i=o.value.halftime_duration_minutes||10,l=o.value.tournament_start_time||"09:00:00";a.division_id=r?.id||"",a.group_id="",a.team_a="",a.team_b="",a.start_time=N(l)||"09:00",a.quarters_count=e,a.quarter_duration_minutes=s,a.break_duration_minutes=n,a.halftime_duration_minutes=i,ue.value=!0}function pe(){ue.value=!1,a.division_id="",a.group_id="",a.team_a="",a.team_b="",a.start_time="09:00",a.quarters_count=4,a.quarter_duration_minutes=15,a.break_duration_minutes=2,a.halftime_duration_minutes=10}async function Ie(){if(o.value)try{const r=a.start_time+":00",e=a.quarters_count*a.quarter_duration_minutes*60,n=k.value.find(y=>y.id===a.division_id)?.type==="group"?"group":"knockout",i=a.team_a.includes("_position_"),l=a.team_b.includes("_position_");let b=a.team_a,c=a.team_b,w=null,M=null;if(i||l){if(I.value.length===0){alert("No teams available. Please create teams first.");return}const y=I.value[0],U=I.value.length>1?I.value[1]:y;if(i){const G=se.value.find(P=>P.id===a.team_a&&P.isPlaceholder);if(G){const P=a.team_a.split("_position_"),H=P[0],K=parseInt(P[1]||"0");w={groupId:H,position:K,placeholderId:a.team_a,name:G.name},b=y.id}}if(l){const G=se.value.find(P=>P.id===a.team_b&&P.isPlaceholder);if(G){const P=a.team_b.split("_position_"),H=P[0],K=parseInt(P[1]||"0");M={groupId:H,position:K,placeholderId:a.team_b,name:G.name},c=U.id}}}const E={tournament_id:o.value.id,division_id:a.division_id,group_id:a.group_id||null,team_a:b,team_b:c,start_time:r,quarters_count:a.quarters_count,quarter_duration_minutes:a.quarter_duration_minutes,break_duration_minutes:a.break_duration_minutes,halftime_duration_minutes:a.halftime_duration_minutes,status:"pending",match_type:n,score_a:0,score_b:0,time_left:e,maddie:!1,boosters:{team_a_placeholder:w?.name||null,team_b_placeholder:M?.name||null,team_a_config:w,team_b_config:M},cards:{}},{data:q,error:D}=await x.from("matches").insert([E]).select().single();if(D){console.error("Error adding match:",D),alert("Failed to add match. Please try again.");return}if(q){z.value.push(q),$.value[a.division_id]||($.value[a.division_id]=[]);const y=$.value[a.division_id];y&&y.push(q),console.log("âœ… Match added successfully"),pe(),await be()}}catch(r){console.error("Error adding match:",r),alert("Failed to add match. Please try again.")}}async function fe(r){const e=F.value.find(n=>n.id===r);if(!e)return;const s=`Are you sure you want to delete "${e.name}"? This will permanently delete:

â€¢ The tournament and all its settings
â€¢ All divisions and groups
â€¢ All matches (scheduled and completed)
â€¢ All team participations

This action cannot be undone.`;if(confirm(s))try{const{error:n}=await x.from("matches").delete().eq("tournament_id",r);if(n){console.error("Error deleting matches:",n),alert("Failed to delete tournament matches. Please try again.");return}const{error:i}=await x.from("tournament_team_participations").delete().eq("tournament_id",r);if(i){console.error("Error deleting team participations:",i),alert("Failed to delete team participations. Please try again.");return}const{error:l}=await x.from("tournament_groups").delete().in("division_id",k.value.filter(w=>w.tournament_id===r).map(w=>w.id));if(l){console.error("Error deleting tournament groups:",l),alert("Failed to delete tournament groups. Please try again.");return}const{error:b}=await x.from("tournament_divisions").delete().eq("tournament_id",r);if(b){console.error("Error deleting divisions:",b),alert("Failed to delete divisions. Please try again.");return}const{error:c}=await x.from("tournaments").delete().eq("id",r);if(c){console.error("Error deleting tournament:",c),alert("Failed to delete tournament. Please try again.");return}F.value=F.value.filter(w=>w.id!==r),o.value?.id===r&&(o.value=null,k.value=[],z.value=[]),console.log("âœ… Tournament deleted successfully"),alert("Tournament deleted successfully!")}catch(n){console.error("Error:",n),alert("Failed to delete tournament. Please try again.")}}function Ne(r){ce.push(`/admin/tournaments/division/${r.id}`)}function he(){p.name="",p.start_date="",p.end_date="",p.description="",p.quarters_count=4,p.quarter_duration_minutes=15,p.break_duration_minutes=2,p.halftime_duration_minutes=10,p.tournament_start_time="09:00",p.match_gap_minutes=15}function ve(){T.name="",T.type="",T.numGroups=2,T.teamsPerGroup=4}function re(r){return new Date(r).toLocaleDateString()}function ge(r){switch(r){case"setup":return"bg-yellow-500/20 text-yellow-300";case"active":return"bg-green-500/20 text-green-300";case"finished":return"bg-blue-500/20 text-blue-300";default:return"bg-gray-500/20 text-gray-300"}}function je(r){return ae.value.filter(e=>e.group_id===r).length}function He(r){if(!o.value)return 0;const s=(A.value[r]||[]).map(i=>i.id);return ae.value.filter(i=>i.group_id&&s.includes(i.group_id)).length}function ne(r){return $.value[r.id]||[]}function oe(r){return ne(r).length}function Oe(){return k.value.reduce((r,e)=>r+oe(e),0)}function ie(r,e){if(e&&e.boosters){if(e.team_a===r&&e.boosters.team_a_placeholder)return e.boosters.team_a_placeholder;if(e.team_b===r&&e.boosters.team_b_placeholder)return e.boosters.team_b_placeholder}const s=I.value.find(n=>n.id===r);return s?s.name:`Team ${r.substring(0,8)}`}function O(r,e){if(!o.value)return"09:00:00";const s=Me(o.value,100),n=k.value.findIndex(i=>i.id===r.id)*10;return s[n+e]||"09:00:00"}async function Qe(r){try{if(!o.value){alert("No tournament selected");return}if(k.value.findIndex(y=>y.id===r.id)>0&&r.type!=="group"){await ze(r);return}const{data:n,error:i}=await x.from("tournament_team_participations").select(`
        *,
        teams:team_id (id, name, players),
        tournament_groups:group_id (id, name, division_id)
      `).eq("tournament_id",o.value.id);if(i){console.error("Error fetching team participations:",i),alert("Failed to load team assignments. Please try again.");return}const l=n?.filter(y=>y.tournament_groups?.division_id===r.id).map(y=>y.teams)||[];if(l.length<2){alert(`Need at least 2 teams assigned to this division to generate matches. Currently ${l.length} teams assigned.`);return}const{data:b}=await x.from("matches").select("id").eq("division_id",r.id).eq("tournament_id",o.value.id);if(b&&b.length>0){if(!confirm(`This division already has ${b.length} matches. Do you want to delete them and generate new ones?`))return;const{error:U}=await x.from("matches").delete().eq("division_id",r.id).eq("tournament_id",o.value.id);if(U){console.error("Error deleting existing matches:",U),alert("Failed to delete existing matches. Please try again.");return}}const c=[],w=o.value.quarter_duration_minutes||15,M=o.value.quarters_count||4,E=w*M*60;if(r.type==="group")for(let y=0;y<l.length;y++)for(let U=y+1;U<l.length;U++){const G=l[y],P=l[U];if(!G||!P)continue;const H=O(r,c.length),K={team_a:G.id,team_b:P.id,status:"pending",division_id:r.id,tournament_id:o.value.id,match_type:"group",score_a:0,score_b:0,time_left:E,maddie:!1,boosters:{},cards:{},start_time:H};c.push(K)}else if(r.type==="knockout")for(let y=0;y<l.length-1;y+=2){const U=l[y],G=l[y+1];if(!U||!G)continue;const P=O(r,c.length),H={team_a:U.id,team_b:G.id,status:"pending",division_id:r.id,tournament_id:o.value.id,match_type:"knockout",round_number:1,match_order:c.length,score_a:0,score_b:0,time_left:E,maddie:!1,boosters:{},cards:{},start_time:P};c.push(H)}if(c.length===0){alert("No matches could be generated. Check division configuration and team assignments.");return}const{data:q,error:D}=await x.from("matches").insert(c).select();if(D){console.error("Error saving matches:",D),alert("Failed to save matches to database. Please try again.");return}q&&(await W(o.value.id),console.log(`Generated and saved ${q.length} matches for division: ${r.name}`),alert(`Successfully generated ${q.length} matches for ${r.name}!`))}catch(e){console.error("Error generating schedule:",e),alert("An error occurred while generating the schedule. Please try again.")}}async function ze(r){R.value=r,B.value=[],await Le(r),le.value=!0}async function Le(r){try{if(!o.value)return;const e=k.value.findIndex(l=>l.id===r.id);if(e<=0)return;const s=k.value[e-1];if(!s||s.type!=="group")return;const n=A.value[s.id]||[],i=[];for(const l of n){const b=[];for(let c=1;c<=4;c++)b.push({id:`${l.id}_position_${c}`,name:`${c}${xe(c)} from ${l.name}`,position:c,groupId:l.id,groupName:l.name,isPlaceholder:!0});i.push({groupId:l.id,groupName:l.name,teams:b})}te.value=i}catch(e){console.error("Error loading previous phase results:",e)}}function xe(r){switch(r){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}function Re(r,e){B.value.some(s=>s.id===r.id)||B.value.push({id:r.id,name:r.name,source:e})}function We(r){B.value.splice(r,1)}function Ke(r,e){const s=B.value.findIndex(n=>n.id===r.id);s>=0?B.value.splice(s,1):B.value.push({id:r.id,name:r.name,source:e})}function me(){le.value=!1,R.value=null,B.value=[],te.value=[]}async function Ye(){if(!R.value||B.value.length<2)return;const r=R.value,e=B.value;console.log("ðŸ’ confirmTeamSelection called with:",{division:r.name,divisionType:r.type,selectedTeamsCount:e.length,selectedTeams:e}),e.filter(n=>n.id.includes("_position_"));const s=e.filter(n=>!n.id.includes("_position_"));try{if(s.length>0){const n=s.map(l=>({tournament_id:o.value.id,team_id:l.id,group_id:null,position_in_group:null})),{error:i}=await x.from("tournament_team_participations").upsert(n,{onConflict:"tournament_id,team_id"});if(i){console.error("Error saving team assignments:",i),alert("Failed to assign teams. Please try again.");return}}await Je(r,e),me()}catch(n){console.error("Error confirming team selection:",n),alert("An error occurred. Please try again.")}}async function Je(r,e){if(!o.value)return;console.log("ðŸ’ generateMatchesWithPlaceholders called with:",{division:r.name,divisionType:r.type,selectedTeamsCount:e.length,selectedTeams:e});const{data:s}=await x.from("matches").select("id").eq("division_id",r.id).eq("tournament_id",o.value.id);if(s&&s.length>0){if(!confirm(`This division already has ${s.length} matches. Do you want to delete them and generate new ones?`))return;const{error:q}=await x.from("matches").delete().eq("division_id",r.id).eq("tournament_id",o.value.id);if(q){console.error("Error deleting existing matches:",q),alert("Failed to delete existing matches. Please try again.");return}}const n=[],i=o.value.quarter_duration_minutes||15,l=o.value.quarters_count||4,b=i*l*60,c=I.value[0];if(!c&&e.some(E=>E.id.includes("_position_"))){alert("No teams available to use as placeholder. Please create teams first.");return}if(r.type==="knockout")for(let E=0;E<e.length;E+=2){const q=e[E],D=e[E+1];if(!q||!D)continue;const y=O(r,n.length),U={team_a:q.id.includes("_position_")&&c?.id||q.id,team_b:D.id.includes("_position_")&&c?.id||D.id,status:"pending",division_id:r.id,tournament_id:o.value.id,match_type:r.type,round_number:1,match_order:n.length,score_a:0,score_b:0,time_left:b,maddie:!1,boosters:{team_a_placeholder:q.id.includes("_position_")?q.name:null,team_b_placeholder:D.id.includes("_position_")?D.name:null,team_a_config:q.id.includes("_position_")?{groupId:q.groupId,position:q.position,placeholderId:q.id}:null,team_b_config:D.id.includes("_position_")?{groupId:D.groupId,position:D.position,placeholderId:D.id}:null},cards:{},start_time:y};n.push(U)}if(console.log("ðŸ’ Final matches array for generateMatchesWithPlaceholders:",{matchesCount:n.length,matches:n}),n.length===0){alert("No matches could be generated. Check division configuration and team assignments.");return}const{data:w,error:M}=await x.from("matches").insert(n).select();if(M){console.error("Error saving matches:",M),alert("Failed to save matches to database. Please try again.");return}w&&($.value[r.id]||($.value[r.id]=[]),$.value[r.id]=w,console.log(`Generated and saved ${w.length} matches for division: ${r.name}`),alert(`Successfully generated ${w.length} matches for ${r.name} with placeholder teams!`))}async function Xe(r){if(o.value)try{const{data:e,error:s}=await x.from("matches").select("*").eq("division_id",r).eq("tournament_id",o.value.id);if(s){console.error("Error fetching matches:",s);return}for(const n of e||[]){let i=!1;const l={};if(n.boosters?.team_a_placeholder){const b=n.boosters.team_a_config;if(b){const c=await we(b.groupId,b.position);c&&(l.team_a=c.id,i=!0)}}if(n.boosters?.team_b_placeholder){const b=n.boosters.team_b_config;if(b){const c=await we(b.groupId,b.position);c&&(l.team_b=c.id,i=!0)}}if(i){const b={...n.boosters};delete b.team_a_placeholder,delete b.team_b_placeholder,delete b.team_a_config,delete b.team_b_config,l.boosters=b;const{error:c}=await x.from("matches").update(l).eq("id",n.id);c?console.error("Error updating match:",c):console.log(`Updated match ${n.id} with actual teams`)}}await W(o.value.id)}catch(e){console.error("Error resolving placeholder teams:",e)}}async function we(r,e){try{const{data:s}=await x.rpc("get_group_standings",{group_uuid:r});return s&&s.length>=e?{id:s[e-1].team_id,name:s[e-1].team_name}:null}catch(s){return console.error("Error getting team by position:",s),null}}function Ze(r){return($.value[r.id]||[]).some(s=>s.boosters?.team_a_placeholder||s.boosters?.team_b_placeholder)}async function et(r){try{await ce.push({name:"division-management",params:{divisionId:r.id}})}catch(e){console.error("Error navigating to division:",e),alert("Failed to navigate to division view. Please try again.")}}function tt(){o.value&&(_.id=o.value.id,_.name=o.value.name,_.start_date=o.value.start_date,_.end_date=o.value.end_date||"",_.description=o.value.description||"",_.quarters_count=o.value.quarters_count||4,_.quarter_duration_minutes=o.value.quarter_duration_minutes||15,_.break_duration_minutes=o.value.break_duration_minutes||2,_.halftime_duration_minutes=o.value.halftime_duration_minutes||10,_.tournament_start_time=N(o.value.tournament_start_time)||"09:00",_.match_gap_minutes=o.value.match_gap_minutes||15,Z.value=!0)}const ye=()=>{!document.hidden&&o.value&&be()};return ot(async()=>{await Promise.all([qe(),Te()]),ke.value=!1,document.addEventListener("visibilitychange",ye)}),it(()=>{document.removeEventListener("visibilitychange",ye)}),(r,e)=>(d(),u(S,null,[t("div",_t,[t("div",pt,[e[68]||(e[68]=t("div",{class:"mb-8"},[t("h1",{class:"text-4xl font-bold text-white mb-2"},"Tournament Management"),t("p",{class:"text-blue-200"},"Create and manage tournaments with group and knockout phases")],-1)),t("div",ft,[t("div",ht,[e[49]||(e[49]=t("h2",{class:"text-2xl font-bold text-white"},"Tournaments",-1)),t("div",vt,[at(ut(dt),{to:"/admin/tournaments/builder",class:"btn btn-secondary"},{default:lt(()=>[...e[48]||(e[48]=[mt(" ðŸ—ï¸ Tournament Builder ",-1)])]),_:1}),t("button",{onClick:e[0]||(e[0]=s=>L.value=!0),class:"btn btn-primary"}," Create Tournament ")])]),F.value.length>0?(d(),u("div",gt,[(d(!0),u(S,null,V(F.value,s=>(d(),u("div",{key:s.id,class:j(["bg-white/5 rounded-lg p-4 border border-white/10 hover:border-white/30 transition-colors relative",{"border-yellow-400 bg-yellow-400/10":o.value?.id===s.id}])},[t("div",{onClick:n=>De(s),class:"cursor-pointer"},[t("h3",wt,m(s.name),1),t("div",yt,[t("div",null,m(re(s.start_date)),1),s.end_date?(d(),u("div",kt,"- "+m(re(s.end_date)),1)):v("",!0),t("div",qt,[t("span",{class:j(["inline-block px-2 py-1 rounded text-xs",ge(s.status)])},m(s.status),3)])])],8,xt),t("button",{onClick:Q(n=>fe(s.id),["stop"]),class:j(["absolute top-2 right-2 btn btn-xs bg-red-600 hover:bg-red-700 text-white opacity-0 hover:opacity-100 transition-opacity",{"opacity-100":o.value?.id===s.id}]),title:"Delete Tournament"}," ðŸ—‘ï¸ ",10,Tt)],2))),128))])):(d(),u("div",Dt,[e[50]||(e[50]=t("div",{class:"text-white/60 mb-4"},"No tournaments created yet",-1)),t("button",{onClick:e[1]||(e[1]=s=>L.value=!0),class:"btn btn-primary"}," Create Your First Tournament ")]))]),o.value?(d(),u("div",Mt,[t("div",Et,[t("div",Ct,[t("h2",St,m(o.value.name),1),t("div",Pt,[t("button",{onClick:e[2]||(e[2]=s=>tt()),class:"btn btn-secondary"}," Edit Info "),o.value.status==="setup"?(d(),u("button",{key:0,onClick:Be,class:"btn btn-success"}," Start Tournament ")):v("",!0),t("button",{onClick:e[3]||(e[3]=s=>fe(o.value.id)),class:"btn bg-red-600 hover:bg-red-700 text-white",title:"Delete Tournament"}," ðŸ—‘ï¸ Delete ")])]),t("div",$t,[t("div",null,[e[51]||(e[51]=t("span",{class:"text-blue-200"},"Start Date:",-1)),t("div",Bt,m(re(o.value.start_date)),1)]),o.value.end_date?(d(),u("div",Ut,[e[52]||(e[52]=t("span",{class:"text-blue-200"},"End Date:",-1)),t("div",Vt,m(re(o.value.end_date)),1)])):v("",!0),t("div",null,[e[53]||(e[53]=t("span",{class:"text-blue-200"},"Status:",-1)),t("div",Ft,[t("span",{class:j(["inline-block px-2 py-1 rounded text-xs font-semibold",ge(o.value.status)])},m(o.value.status),3)])])]),o.value.description?(d(),u("div",Gt,[e[54]||(e[54]=t("span",{class:"text-blue-200"},"Description:",-1)),t("p",At,m(o.value.description),1)])):v("",!0),t("div",It,[e[63]||(e[63]=t("h4",{class:"text-blue-200 font-semibold mb-3"},"Match Configuration",-1)),t("div",Nt,[t("div",null,[e[55]||(e[55]=t("span",{class:"text-blue-200"},"Quarters:",-1)),t("div",jt,m(o.value.quarters_count||4),1)]),t("div",null,[e[56]||(e[56]=t("span",{class:"text-blue-200"},"Quarter Length:",-1)),t("div",Ht,m(o.value.quarter_duration_minutes||15)+"min",1)]),t("div",null,[e[57]||(e[57]=t("span",{class:"text-blue-200"},"Break Time:",-1)),t("div",Ot,m(o.value.break_duration_minutes||2)+"min",1)]),t("div",null,[e[58]||(e[58]=t("span",{class:"text-blue-200"},"Halftime:",-1)),t("div",Qt,m(o.value.halftime_duration_minutes||10)+"min",1)])]),t("div",zt,[t("div",null,[e[59]||(e[59]=t("span",{class:"text-blue-200"},"Start Time:",-1)),t("div",Lt,m(N(o.value.tournament_start_time)||"09:00"),1)]),t("div",null,[e[60]||(e[60]=t("span",{class:"text-blue-200"},"Match Gap:",-1)),t("div",Rt,m(o.value.match_gap_minutes||15)+"min",1)]),t("div",null,[e[61]||(e[61]=t("span",{class:"text-blue-200"},"Match Slot:",-1)),t("div",Wt,m(de()+(o.value.match_gap_minutes||15))+"min",1)])]),t("div",Kt," Match duration: "+m(de())+"min + "+m(o.value.match_gap_minutes||15)+"min gap = "+m(de()+(o.value.match_gap_minutes||15))+"min per slot ",1),t("div",Yt,[t("div",Jt,[e[62]||(e[62]=t("div",{class:"text-xs text-blue-200"},"Tournament Schedule Overview:",-1)),t("div",Xt,m(Oe())+" total matches",1)]),t("div",Zt,[(d(!0),u(S,null,V(k.value.slice(0,2),s=>(d(),u("div",{key:s.id,class:"text-xs"},[t("div",es,m(s.name)+":",1),t("div",ts,[(d(!0),u(S,null,V(ne(s).slice(0,2),(n,i)=>(d(),u("div",{key:n.id,class:"text-white/60"},m(N(n.start_time)||N(O(s,i)))+" - "+m(ie(n.team_a,n))+" vs "+m(ie(n.team_b,n)),1))),128)),ne(s).length===0?(d(),u("div",ss," No matches scheduled ")):v("",!0)])]))),128)),k.value.length>2?(d(),u("div",rs," +"+m(k.value.length-2)+" more divisions... ",1)):v("",!0)])])])]),t("div",ns,[t("div",os,[e[64]||(e[64]=t("h3",{class:"text-xl font-bold text-white"},"Tournament Structure",-1)),t("button",{onClick:e[4]||(e[4]=s=>X.value=!0),class:"btn btn-primary",disabled:o.value.status!=="setup"}," Add Division ",8,is)]),k.value.length>0?(d(),u("div",as,[(d(!0),u(S,null,V(k.value,(s,n)=>(d(),u("div",{key:s.id,class:"bg-white/5 rounded-lg p-4 border border-white/10"},[t("div",ls,[t("div",us,[t("h4",ds,m(n+1)+". "+m(s.name),1),t("span",{class:j(["px-2 py-1 rounded text-xs font-semibold",s.type==="group"?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300"])},m(s.type==="group"?"Group Phase":"Knockout Phase"),3)]),t("div",ms,[t("button",{onClick:i=>Ne(s),class:"btn btn-sm btn-secondary"}," Manage ",8,cs),o.value.status==="setup"?(d(),u("button",{key:0,onClick:i=>Ue(s.id),class:"btn btn-sm btn-danger"}," Delete ",8,bs)):v("",!0)])]),s.type==="group"&&A.value[s.id]&&A.value[s.id].length>0?(d(),u("div",_s,[e[65]||(e[65]=t("h5",{class:"text-white font-semibold"},"Groups:",-1)),t("div",ps,[(d(!0),u(S,null,V(A.value[s.id],i=>(d(),u("div",{key:i.id,class:"bg-white/5 rounded p-2 text-center"},[t("div",fs,m(i.name),1),t("div",hs,m(je(i.id))+" teams ",1)]))),128))])])):v("",!0),s.type==="knockout"?(d(),u("div",vs,m(He(s.id))+" teams registered ",1)):v("",!0),t("div",gs,[t("div",xs,[e[66]||(e[66]=t("h5",{class:"text-white font-semibold"},"Scheduled Matches",-1)),t("div",ws,[o.value.status==="setup"?(d(),u("button",{key:0,onClick:i=>Ae(s),class:"btn btn-xs btn-success",title:"Add individual match"}," + Add Match ",8,ys)):v("",!0),o.value.status==="setup"?(d(),u("button",{key:1,onClick:i=>Qe(s),class:"btn btn-xs btn-primary"}," Generate Schedule ",8,ks)):v("",!0),Ze(s)?(d(),u("button",{key:2,onClick:i=>Xe(s.id),class:"btn btn-xs btn-accent"}," Update Teams ",8,qs)):v("",!0),t("button",{onClick:i=>et(s),class:"btn btn-xs btn-secondary"}," View All Matches ",8,Ts)])]),oe(s)>0?(d(),u("div",Ds,[(d(!0),u(S,null,V(ne(s).slice(0,3),(i,l)=>(d(),u("div",{key:i.id,class:"bg-white/5 rounded p-3 text-sm"},[t("div",Ms,[t("div",Es,[t("div",Cs,m(N(i.start_time)||N(O(s,l))),1),t("div",Ss,m(ie(i.team_a,i))+" vs "+m(ie(i.team_b,i)),1)]),t("div",Ps,[t("div",$s,m(i.status||"Scheduled"),1),o.value.status==="setup"?(d(),u("button",{key:0,onClick:b=>Ve(i),class:"btn btn-xs bg-blue-600 hover:bg-blue-700 text-white",title:"Edit Match Settings"}," âš™ï¸ ",8,Bs)):v("",!0),o.value.status==="setup"?(d(),u("button",{key:1,onClick:b=>Ge(i.id),class:"btn btn-xs bg-red-600 hover:bg-red-700 text-white",title:"Delete Match"}," ðŸ—‘ï¸ ",8,Us)):v("",!0)])])]))),128)),oe(s)>3?(d(),u("div",Vs," +"+m(oe(s)-3)+" more matches... ",1)):v("",!0)])):(d(),u("div",Fs," No matches scheduled yet "))])]))),128))])):(d(),u("div",Gs,[...e[67]||(e[67]=[t("div",{class:"text-white/60 mb-4"},"No divisions created yet",-1),t("div",{class:"text-sm text-blue-200"}," Add group phases for round-robin matches or knockout phases for elimination rounds ",-1)])]))])])):v("",!0)]),L.value?(d(),u("div",As,[t("div",Is,[e[79]||(e[79]=t("h3",{class:"text-xl font-bold text-white mb-4"},"Create Tournament",-1)),t("form",{onSubmit:Q(Ce,["prevent"]),class:"space-y-4"},[t("div",null,[e[69]||(e[69]=t("label",{class:"block text-blue-200 text-sm font-semibold mb-2"},"Tournament Name",-1)),f(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>p.name=s),type:"text",class:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50",placeholder:"Enter tournament name",required:""},null,512),[[g,p.name]])]),t("div",null,[e[70]||(e[70]=t("label",{class:"block text-blue-200 text-sm font-semibold mb-2"},"Start Date",-1)),f(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>p.start_date=s),type:"date",class:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white",required:""},null,512),[[g,p.start_date]])]),t("div",null,[e[71]||(e[71]=t("label",{class:"block text-blue-200 text-sm font-semibold mb-2"},"End Date (Optional)",-1)),f(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>p.end_date=s),type:"date",class:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white"},null,512),[[g,p.end_date]])]),t("div",null,[e[72]||(e[72]=t("label",{class:"block text-blue-200 text-sm font-semibold mb-2"},"Description (Optional)",-1)),f(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=s=>p.description=s),class:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 resize-none",rows:"3",placeholder:"Enter tournament description"},null,512),[[g,p.description]])]),t("div",Ns,[e[74]||(e[74]=t("h4",{class:"text-blue-200 font-semibold mb-3"},"Match Duration Settings",-1)),t("div",js,[t("div",null,[t("label",Hs,m(p.quarters_count===2?"Halves":"Quarters"),1),f(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>p.quarters_count=s),type:"number",min:"1",max:"6",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm"},null,512),[[g,p.quarters_count,void 0,{number:!0}]])]),t("div",null,[t("label",Os,m(p.quarters_count===2?"Half Duration (min)":"Quarter Duration (min)"),1),f(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>p.quarter_duration_minutes=s),type:"number",min:"5",max:"30",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm"},null,512),[[g,p.quarter_duration_minutes,void 0,{number:!0}]])]),p.quarters_count>2?(d(),u("div",Qs,[e[73]||(e[73]=t("label",{class:"block text-blue-200 text-xs font-semibold mb-1"},"Break Duration (min)",-1)),f(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>p.break_duration_minutes=s),type:"number",min:"1",max:"10",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm"},null,512),[[g,p.break_duration_minutes,void 0,{number:!0}]])])):v("",!0),p.quarters_count>1?(d(),u("div",zs,[t("label",Ls,m((p.quarters_count===2,"Halftime (min)")),1),f(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>p.halftime_duration_minutes=s),type:"number",min:"0",max:"20",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm"},null,512),[[g,p.halftime_duration_minutes,void 0,{number:!0}]])])):v("",!0)]),t("div",Rs," Total match time: "+m(_e())+" minutes ",1)]),t("div",Ws,[e[77]||(e[77]=t("h4",{class:"text-blue-200 font-semibold mb-3"},"Match Scheduling",-1)),t("div",Ks,[t("div",null,[e[75]||(e[75]=t("label",{class:"block text-blue-200 text-xs font-semibold mb-1"},"Tournament Start Time",-1)),f(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>p.tournament_start_time=s),type:"time",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm"},null,512),[[g,p.tournament_start_time]])]),t("div",null,[e[76]||(e[76]=t("label",{class:"block text-blue-200 text-xs font-semibold mb-1"},"Gap Between Matches (min)",-1)),f(t("input",{"onUpdate:modelValue":e[14]||(e[14]=s=>p.match_gap_minutes=s),type:"number",min:"5",max:"60",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm"},null,512),[[g,p.match_gap_minutes,void 0,{number:!0}]])])]),t("div",Ys," Match window: "+m(_e()+p.match_gap_minutes)+" minutes per match slot ",1)]),t("div",Js,[e[78]||(e[78]=t("button",{type:"submit",class:"flex-1 btn btn-primary"}," Create Tournament ",-1)),t("button",{type:"button",onClick:e[15]||(e[15]=s=>{L.value=!1,he()}),class:"flex-1 btn btn-secondary"}," Cancel ")])],32)])])):v("",!0),X.value?(d(),u("div",Xs,[t("div",Zs,[e[86]||(e[86]=t("h3",{class:"text-xl font-bold text-white mb-4"},"Add Division",-1)),t("form",{onSubmit:Q(Se,["prevent"]),class:"space-y-4"},[t("div",null,[e[80]||(e[80]=t("label",{class:"block text-blue-200 text-sm font-semibold mb-2"},"Division Name",-1)),f(t("input",{"onUpdate:modelValue":e[16]||(e[16]=s=>T.name=s),type:"text",class:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50",placeholder:"e.g. Group Stage, Quarter Finals",required:""},null,512),[[g,T.name]])]),t("div",null,[e[82]||(e[82]=t("label",{class:"block text-blue-200 text-sm font-semibold mb-2"},"Division Type",-1)),f(t("select",{"onUpdate:modelValue":e[17]||(e[17]=s=>T.type=s),class:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white",required:""},[...e[81]||(e[81]=[t("option",{value:""},"Select type",-1),t("option",{value:"group"},"Group Phase (Round Robin)",-1),t("option",{value:"knockout"},"Knockout Phase (Elimination)",-1)])],512),[[J,T.type]])]),T.type==="group"?(d(),u("div",er,[t("div",null,[e[83]||(e[83]=t("label",{class:"block text-blue-200 text-sm font-semibold mb-2"},"Number of Groups",-1)),f(t("input",{"onUpdate:modelValue":e[18]||(e[18]=s=>T.numGroups=s),type:"number",min:"1",max:"8",class:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white",placeholder:"How many groups?"},null,512),[[g,T.numGroups,void 0,{number:!0}]])]),t("div",null,[e[84]||(e[84]=t("label",{class:"block text-blue-200 text-sm font-semibold mb-2"},"Teams per Group",-1)),f(t("input",{"onUpdate:modelValue":e[19]||(e[19]=s=>T.teamsPerGroup=s),type:"number",min:"2",max:"8",class:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white",placeholder:"How many teams per group?"},null,512),[[g,T.teamsPerGroup,void 0,{number:!0}]])])])):v("",!0),t("div",tr,[e[85]||(e[85]=t("button",{type:"submit",class:"flex-1 btn btn-primary"}," Add Division ",-1)),t("button",{type:"button",onClick:e[20]||(e[20]=s=>{X.value=!1,ve()}),class:"flex-1 btn btn-secondary"}," Cancel ")])],32)])])):v("",!0),Z.value?(d(),u("div",sr,[t("div",rr,[e[98]||(e[98]=t("h3",{class:"text-xl font-bold text-white mb-4"},"Edit Tournament",-1)),t("form",{onSubmit:Q(Pe,["prevent"]),class:"space-y-4"},[t("div",null,[e[87]||(e[87]=t("label",{class:"block text-blue-200 text-sm font-semibold mb-2"},"Tournament Name",-1)),f(t("input",{"onUpdate:modelValue":e[21]||(e[21]=s=>_.name=s),type:"text",class:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white",required:""},null,512),[[g,_.name]])]),t("div",null,[e[88]||(e[88]=t("label",{class:"block text-blue-200 text-sm font-semibold mb-2"},"Start Date",-1)),f(t("input",{"onUpdate:modelValue":e[22]||(e[22]=s=>_.start_date=s),type:"date",class:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white",required:""},null,512),[[g,_.start_date]])]),t("div",null,[e[89]||(e[89]=t("label",{class:"block text-blue-200 text-sm font-semibold mb-2"},"End Date (Optional)",-1)),f(t("input",{"onUpdate:modelValue":e[23]||(e[23]=s=>_.end_date=s),type:"date",class:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white"},null,512),[[g,_.end_date]])]),t("div",null,[e[90]||(e[90]=t("label",{class:"block text-blue-200 text-sm font-semibold mb-2"},"Description (Optional)",-1)),f(t("textarea",{"onUpdate:modelValue":e[24]||(e[24]=s=>_.description=s),class:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white resize-none",rows:"3"},null,512),[[g,_.description]])]),t("div",nr,[e[93]||(e[93]=t("h4",{class:"text-blue-200 font-semibold mb-3"},"Match Duration Settings",-1)),t("div",or,[t("div",null,[t("label",ir,m(_.quarters_count===2?"Halves":"Quarters"),1),f(t("input",{"onUpdate:modelValue":e[25]||(e[25]=s=>_.quarters_count=s),type:"number",min:"1",max:"6",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm"},null,512),[[g,_.quarters_count,void 0,{number:!0}]])]),t("div",null,[t("label",ar,m(_.quarters_count===2?"Half Duration (min)":"Quarter Duration (min)"),1),f(t("input",{"onUpdate:modelValue":e[26]||(e[26]=s=>_.quarter_duration_minutes=s),type:"number",min:"5",max:"30",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm"},null,512),[[g,_.quarter_duration_minutes,void 0,{number:!0}]])]),_.quarters_count>2?(d(),u("div",lr,[e[91]||(e[91]=t("label",{class:"block text-blue-200 text-xs font-semibold mb-1"},"Break Duration (min)",-1)),f(t("input",{"onUpdate:modelValue":e[27]||(e[27]=s=>_.break_duration_minutes=s),type:"number",min:"1",max:"10",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm"},null,512),[[g,_.break_duration_minutes,void 0,{number:!0}]])])):v("",!0),_.quarters_count>1?(d(),u("div",ur,[e[92]||(e[92]=t("label",{class:"block text-blue-200 text-xs font-semibold mb-1"},"Halftime Duration (min)",-1)),f(t("input",{"onUpdate:modelValue":e[28]||(e[28]=s=>_.halftime_duration_minutes=s),type:"number",min:"0",max:"20",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm"},null,512),[[g,_.halftime_duration_minutes,void 0,{number:!0}]])])):v("",!0)])]),t("div",dr,[e[96]||(e[96]=t("h4",{class:"text-blue-200 font-semibold mb-3"},"Match Scheduling",-1)),t("div",mr,[t("div",null,[e[94]||(e[94]=t("label",{class:"block text-blue-200 text-xs font-semibold mb-1"},"Tournament Start Time",-1)),f(t("input",{"onUpdate:modelValue":e[29]||(e[29]=s=>_.tournament_start_time=s),type:"time",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm"},null,512),[[g,_.tournament_start_time]])]),t("div",null,[e[95]||(e[95]=t("label",{class:"block text-blue-200 text-xs font-semibold mb-1"},"Gap Between Matches (min)",-1)),f(t("input",{"onUpdate:modelValue":e[30]||(e[30]=s=>_.match_gap_minutes=s),type:"number",min:"5",max:"60",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm"},null,512),[[g,_.match_gap_minutes,void 0,{number:!0}]])])])]),t("div",cr,[e[97]||(e[97]=t("button",{type:"submit",class:"flex-1 btn btn-primary"}," Update Tournament ",-1)),t("button",{type:"button",onClick:e[31]||(e[31]=s=>Z.value=!1),class:"flex-1 btn btn-secondary"}," Cancel ")])],32)])])):v("",!0),ee.value?(d(),u("div",br,[t("div",_r,[e[103]||(e[103]=t("h3",{class:"text-xl font-bold text-white mb-4"},"Edit Match Settings",-1)),t("form",{onSubmit:Q(Fe,["prevent"]),class:"space-y-4"},[t("div",null,[e[99]||(e[99]=t("label",{class:"block text-blue-200 text-sm font-semibold mb-2"},"Match Start Time",-1)),f(t("input",{"onUpdate:modelValue":e[32]||(e[32]=s=>h.start_time=s),type:"time",class:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white",required:""},null,512),[[g,h.start_time]])]),t("div",pr,[e[101]||(e[101]=t("h4",{class:"text-blue-200 font-semibold mb-3"},"Match Duration",-1)),t("div",fr,[t("div",null,[t("label",hr,m(h.quarters_count===2?"Halves":"Quarters"),1),f(t("input",{"onUpdate:modelValue":e[33]||(e[33]=s=>h.quarters_count=s),type:"number",min:"1",max:"6",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm",required:""},null,512),[[g,h.quarters_count,void 0,{number:!0}]])]),t("div",null,[t("label",vr,m(h.quarters_count===2?"Half Length (min)":"Quarter Length (min)"),1),f(t("input",{"onUpdate:modelValue":e[34]||(e[34]=s=>h.quarter_duration_minutes=s),type:"number",min:"5",max:"30",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm",required:""},null,512),[[g,h.quarter_duration_minutes,void 0,{number:!0}]])]),h.quarters_count>2?(d(),u("div",gr,[e[100]||(e[100]=t("label",{class:"block text-blue-200 text-xs font-semibold mb-1"},"Break Time (min)",-1)),f(t("input",{"onUpdate:modelValue":e[35]||(e[35]=s=>h.break_duration_minutes=s),type:"number",min:"1",max:"10",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm",required:""},null,512),[[g,h.break_duration_minutes,void 0,{number:!0}]])])):v("",!0),h.quarters_count>1?(d(),u("div",xr,[t("label",wr,m((h.quarters_count===2,"Halftime (min)")),1),f(t("input",{"onUpdate:modelValue":e[36]||(e[36]=s=>h.halftime_duration_minutes=s),type:"number",min:"0",max:"20",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm"},null,512),[[g,h.halftime_duration_minutes,void 0,{number:!0}]])])):v("",!0)]),t("div",yr," Total match time: "+m((()=>{const s=h.quarters_count,n=h.quarter_duration_minutes,i=h.break_duration_minutes,l=h.halftime_duration_minutes,b=s*n;let c=0;return s===1?c=0:s===2?c=l:s>2&&(c=(s-1-1)*i+l),b+c})())+" minutes ",1)]),t("div",kr,[e[102]||(e[102]=t("button",{type:"submit",class:"flex-1 btn btn-primary"}," Save Settings ",-1)),t("button",{type:"button",onClick:e[37]||(e[37]=s=>ee.value=!1),class:"flex-1 btn btn-secondary"}," Cancel ")])],32)])])):v("",!0)]),ue.value?(d(),u("div",qr,[t("div",Tr,[e[117]||(e[117]=t("h3",{class:"text-xl font-bold text-white mb-4"},"Add New Match",-1)),t("form",{onSubmit:Q(Ie,["prevent"]),class:"space-y-4"},[t("div",null,[e[105]||(e[105]=t("label",{class:"block text-blue-200 text-sm font-semibold mb-2"},"Division",-1)),f(t("select",{"onUpdate:modelValue":e[38]||(e[38]=s=>a.division_id=s),class:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white",required:"",onChange:e[39]||(e[39]=s=>a.group_id="")},[e[104]||(e[104]=t("option",{value:"",disabled:""},"Select a division",-1)),(d(!0),u(S,null,V(k.value,s=>(d(),u("option",{key:s.id,value:s.id,class:"bg-gray-800"},m(s.name)+" ("+m(s.type)+") ",9,Dr))),128))],544),[[J,a.division_id]])]),a.division_id&&k.value.find(s=>s.id===a.division_id)?.type==="group"?(d(),u("div",Mr,[e[107]||(e[107]=t("label",{class:"block text-blue-200 text-sm font-semibold mb-2"},"Group (Optional)",-1)),f(t("select",{"onUpdate:modelValue":e[40]||(e[40]=s=>a.group_id=s),class:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white"},[e[106]||(e[106]=t("option",{value:""},"No specific group",-1)),(d(!0),u(S,null,V(A.value[a.division_id]||[],s=>(d(),u("option",{key:s.id,value:s.id,class:"bg-gray-800"},m(s.name),9,Er))),128))],512),[[J,a.group_id]])])):v("",!0),t("div",Cr,[t("div",null,[e[109]||(e[109]=t("label",{class:"block text-blue-200 text-sm font-semibold mb-2"},"Team A",-1)),f(t("select",{"onUpdate:modelValue":e[41]||(e[41]=s=>a.team_a=s),class:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white",required:""},[e[108]||(e[108]=t("option",{value:"",disabled:""},"Select Team A",-1)),(d(!0),u(S,null,V(se.value,s=>(d(),u(S,{key:s.id},[s.divider?(d(),u("optgroup",{key:0,label:s.name},null,8,Sr)):(d(),u("option",{key:1,value:s.id,disabled:s.id===a.team_b,class:j(s.isPlaceholder?"bg-purple-900":"bg-gray-800")},m(s.isPlaceholder?"ðŸ“ ":"")+m(s.name),11,Pr))],64))),128))],512),[[J,a.team_a]])]),t("div",null,[e[111]||(e[111]=t("label",{class:"block text-blue-200 text-sm font-semibold mb-2"},"Team B",-1)),f(t("select",{"onUpdate:modelValue":e[42]||(e[42]=s=>a.team_b=s),class:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white",required:""},[e[110]||(e[110]=t("option",{value:"",disabled:""},"Select Team B",-1)),(d(!0),u(S,null,V(se.value,s=>(d(),u(S,{key:s.id},[s.divider?(d(),u("optgroup",{key:0,label:s.name},null,8,$r)):(d(),u("option",{key:1,value:s.id,disabled:s.id===a.team_a,class:j(s.isPlaceholder?"bg-purple-900":"bg-gray-800")},m(s.isPlaceholder?"ðŸ“ ":"")+m(s.name),11,Br))],64))),128))],512),[[J,a.team_b]])])]),a.team_a.includes("_position_")||a.team_b.includes("_position_")?(d(),u("div",Ur,[...e[112]||(e[112]=[t("div",{class:"flex items-start space-x-2"},[t("span",{class:"text-purple-300"},"ðŸ’¡"),t("p",{class:"text-xs text-purple-200"}," You've selected placeholder team positions. These will be automatically replaced with actual teams once the previous phase is completed. ")],-1)])])):v("",!0),t("div",null,[e[113]||(e[113]=t("label",{class:"block text-blue-200 text-sm font-semibold mb-2"},"Match Start Time",-1)),f(t("input",{"onUpdate:modelValue":e[43]||(e[43]=s=>a.start_time=s),type:"time",class:"w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white",required:""},null,512),[[g,a.start_time]])]),t("div",Vr,[e[115]||(e[115]=t("h4",{class:"text-blue-200 font-semibold mb-3"},"Match Duration",-1)),t("div",Fr,[t("div",null,[t("label",Gr,m(a.quarters_count===2?"Halves":"Quarters"),1),f(t("input",{"onUpdate:modelValue":e[44]||(e[44]=s=>a.quarters_count=s),type:"number",min:"1",max:"6",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm",required:""},null,512),[[g,a.quarters_count,void 0,{number:!0}]])]),t("div",null,[t("label",Ar,m(a.quarters_count===2?"Half Length (min)":"Quarter Length (min)"),1),f(t("input",{"onUpdate:modelValue":e[45]||(e[45]=s=>a.quarter_duration_minutes=s),type:"number",min:"5",max:"30",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm",required:""},null,512),[[g,a.quarter_duration_minutes,void 0,{number:!0}]])]),a.quarters_count>2?(d(),u("div",Ir,[e[114]||(e[114]=t("label",{class:"block text-blue-200 text-xs font-semibold mb-1"},"Break Time (min)",-1)),f(t("input",{"onUpdate:modelValue":e[46]||(e[46]=s=>a.break_duration_minutes=s),type:"number",min:"1",max:"10",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm",required:""},null,512),[[g,a.break_duration_minutes,void 0,{number:!0}]])])):v("",!0),a.quarters_count>1?(d(),u("div",Nr,[t("label",jr,m((a.quarters_count===2,"Halftime (min)")),1),f(t("input",{"onUpdate:modelValue":e[47]||(e[47]=s=>a.halftime_duration_minutes=s),type:"number",min:"0",max:"20",class:"w-full p-2 bg-white/10 border border-white/20 rounded text-white text-sm"},null,512),[[g,a.halftime_duration_minutes,void 0,{number:!0}]])])):v("",!0)]),t("div",Hr," Total match time: "+m((()=>{const s=a.quarters_count,n=a.quarter_duration_minutes,i=a.break_duration_minutes,l=a.halftime_duration_minutes,b=s*n;let c=0;return s===1?c=0:s===2?c=l:s>2&&(c=(s-1-1)*i+l),b+c})())+" minutes ",1)]),t("div",{class:"flex space-x-3 pt-4"},[e[116]||(e[116]=t("button",{type:"submit",class:"flex-1 btn btn-primary"}," Add Match ",-1)),t("button",{type:"button",onClick:pe,class:"flex-1 btn btn-secondary"}," Cancel ")])],32)])])):v("",!0),le.value?(d(),u("div",Or,[t("div",Qr,[t("div",zr,[t("h3",Lr,"Select Teams for "+m(R.value?.name),1),t("button",{onClick:me,class:"text-white hover:text-red-300"},[...e[118]||(e[118]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Rr,[te.value.length>0?(d(),u("div",Wr,[e[119]||(e[119]=t("h4",{class:"text-lg font-semibold text-white mb-4"},"Team Positions from Previous Phase",-1)),t("div",Kr,[(d(!0),u(S,null,V(te.value,s=>(d(),u("div",{key:s.groupId,class:"bg-white/5 rounded-lg p-4"},[t("h5",Yr,m(s.groupName),1),t("div",Jr,[(d(!0),u(S,null,V(s.teams,(n,i)=>(d(),u("div",{key:n.id,class:j(["flex justify-between items-center p-2 bg-white/5 rounded",i<2?"border-l-4 border-green-400":"border-l-4 border-yellow-400"])},[t("span",Xr,m(n.name),1),t("div",Zr,[t("button",{onClick:l=>Re(n,n.name),class:"btn btn-xs btn-primary"}," Select ",8,en)])],2))),128))])]))),128))]),e[120]||(e[120]=t("div",{class:"text-sm text-blue-300 mt-2"}," ðŸ’¡ These are placeholder positions. When group matches are finished, they will be replaced with actual team names. ",-1))])):v("",!0),t("div",null,[t("h4",tn,"Selected Teams ("+m(B.value.length)+")",1),t("div",sn,[(d(!0),u(S,null,V(B.value,(s,n)=>(d(),u("div",{key:s.id,class:"bg-white/5 rounded-lg p-3 flex justify-between items-center"},[t("div",null,[t("div",rn,m(s.name),1),t("div",nn,m(s.source),1)]),t("button",{onClick:i=>We(n),class:"text-red-400 hover:text-red-300"},[...e[121]||(e[121]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,on)]))),128))])]),t("div",null,[e[122]||(e[122]=t("h4",{class:"text-lg font-semibold text-white mb-4"},"All Available Teams",-1)),t("div",an,[(d(!0),u(S,null,V(I.value,s=>(d(),u("label",{key:s.id,class:"flex items-center space-x-2 text-sm text-white cursor-pointer"},[t("input",{type:"checkbox",value:s.id,checked:B.value.some(n=>n.id===s.id),onChange:n=>Ke(s,"Direct selection"),class:"rounded border-white/20"},null,40,ln),t("span",null,m(s.name),1)]))),128))])])]),t("div",un,[t("button",{onClick:me,class:"btn btn-secondary"}," Cancel "),t("button",{onClick:Ye,class:"btn btn-primary",disabled:B.value.length<2}," Generate Schedule ("+m(B.value.length)+" teams) ",9,dn)])])])):v("",!0)],64))}}),pn=bt(mn,[["__scopeId","data-v-c2261df1"]]);export{pn as default};
