import{u as G,s as f,_ as H}from"./index-BEMb2HgI.js";import{e as J,r as c,o as K,g as i,i as e,t as n,l as p,F as T,k as N,x as $,y as g,s as Q,A as j,n as h,h as r}from"./vendor-BHPTlv71.js";const X={class:"min-h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-indigo-900"},Z={class:"container mx-auto px-4 py-8"},ee={class:"text-center mb-8"},te={class:"text-4xl font-bold text-white mb-4"},se={key:0,class:"text-xl text-blue-100"},oe={class:"bg-blue-600 px-4 py-2 rounded-full"},ae={key:1,class:"text-lg text-blue-200"},ne={class:"grid lg:grid-cols-3 gap-8 max-w-7xl mx-auto"},re={class:"lg:col-span-2 space-y-6"},ie={class:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20"},le={class:"flex items-center mb-6"},de={key:0,class:"ml-4 text-sm text-blue-200"},ce={key:0,class:"text-center py-8"},ue={key:1,class:"text-center py-8"},_e={key:2,class:"text-center py-8"},be={key:3,class:"space-y-4"},me={class:"flex justify-between items-center mb-3"},xe={class:"flex items-center space-x-4"},fe={class:"text-lg font-semibold text-white"},pe={class:"text-right text-sm text-blue-200"},ge={class:"flex justify-between items-center"},he={class:"text-2xl font-bold text-white"},ve={class:"text-sm text-blue-200"},we={key:0},ye={key:1,class:"mt-1"},ke={class:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20"},Se={key:0,class:"text-center py-8"},Me={key:1,class:"space-y-3"},De={class:"flex justify-between items-center"},Te={class:"flex items-center space-x-3"},Ne={class:"text-white font-medium"},Le={class:"text-lg font-bold text-white"},Ue={class:"text-xs text-blue-200"},Ae={class:"space-y-6"},Re={class:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20"},Ce={key:0,class:"text-center py-4"},Ee={key:1,class:"text-center py-8"},$e={key:2,class:"space-y-2"},je={class:"flex items-center space-x-3"},qe={class:"font-bold text-white w-6"},Be={key:0,class:"text-xs bg-blue-500 px-2 py-1 rounded"},We={class:"text-right"},Ve={class:"text-white font-bold"},Oe={class:"text-xs text-blue-200"},Fe={class:"mt-8 flex justify-center space-x-4"},Ye=J({__name:"UserDashboardView",setup(Ie){const _=G(),l=c(null),v=c([]),w=c([]),y=c([]),k=c({}),S=c(!0),L=c(!0);function q(){const o=_.user;return o?.user_metadata?.firstName||o?.user_metadata?.lastName?`${o.user_metadata.firstName||""} ${o.user_metadata.lastName||""}`.trim():_.profile?.email?.split("@")[0]||"User"}async function B(){if(_.profile?.assigned_team_id)try{const{data:o,error:s}=await f.from("teams").select("*").eq("id",_.profile.assigned_team_id).single();if(s)throw s;l.value=o}catch(o){console.error("Error loading user team:",o)}}async function W(){try{const{data:o,error:s}=await f.from("teams").select("*");if(s)throw s;const a={};o?.forEach(t=>{a[t.id]=t}),k.value=a}catch(o){console.error("Error loading teams:",o)}}async function V(){if(!l.value){S.value=!1;return}try{const{data:o,error:s}=await f.from("matches").select("*").or(`team_a.eq.${l.value.id},team_b.eq.${l.value.id}`).order("created_at",{ascending:!1});if(s)throw s;const a=o||[];v.value=a.filter(t=>t.status==="pending"||t.status==="active").slice(0,5),w.value=a.filter(t=>t.status==="finished").slice(0,5)}catch(o){console.error("Error loading matches:",o)}finally{S.value=!1}}async function O(){try{const o=Object.values(k.value),s=[];for(const a of o){const{data:t}=await f.from("matches").select("*").or(`team_a.eq.${a.id},team_b.eq.${a.id}`).eq("status","finished");let d=0,m=0,x=0,R=0,C=0;t?.forEach(u=>{const E=u.team_a===a.id,M=E?u.score_a:u.score_b,D=E?u.score_b:u.score_a;R+=M,C+=D,M>D?d++:M<D?m++:x++});const z=d*3+x*1;s.push({id:a.id,name:a.name,points:z,wins:d,losses:m,draws:x,goals_for:R,goals_against:C})}y.value=s.sort((a,t)=>{const d=t.points-a.points;if(d!==0)return d;const m=a.goals_for-a.goals_against;return t.goals_for-t.goals_against-m})}catch(o){console.error("Error loading standings:",o)}finally{L.value=!1}}function b(o){return k.value[o]?.name||"Unknown Team"}function F(o){switch(o){case"active":return"bg-green-500 text-white";case"pending":return"bg-yellow-500 text-black";case"finished":return"bg-gray-500 text-white";default:return"bg-gray-400 text-white"}}function U(o,s){if(!s)return"N/A";const a=o.team_a===s,t=a?o.score_a:o.score_b,d=a?o.score_b:o.score_a;return t>d?"WIN":t<d?"LOSS":"DRAW"}function Y(o,s){switch(U(o,s)){case"WIN":return"bg-green-500 text-white";case"LOSS":return"bg-red-500 text-white";case"DRAW":return"bg-yellow-500 text-black";default:return"bg-gray-400 text-white"}}function A(o){return o.match_date?new Date(o.match_date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}):new Date(o.created_at).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}function I(o){return o.start_time?o.start_time.substring(0,5):new Date(o.created_at).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})}function P(o){const s=Math.floor(o/60),a=o%60;return`${s}:${a.toString().padStart(2,"0")}`}return K(async()=>{await W(),await B(),await Promise.all([V(),O()])}),(o,s)=>{const a=Q("RouterLink");return r(),i("div",X,[e("div",Z,[e("div",ee,[e("h1",te," Welcome, "+n(q())+"! ï¿½ ",1),l.value?(r(),i("div",se,[e("span",oe,n(l.value.name)+" Team Member ",1)])):(r(),i("div",ae," You're not currently assigned to a team "))]),e("div",ne,[e("div",re,[e("div",ie,[e("div",le,[s[0]||(s[0]=e("h2",{class:"text-2xl font-bold text-white"},"ðŸ“… Upcoming Matches",-1)),l.value?(r(),i("div",de," for "+n(l.value.name),1)):p("",!0)]),S.value?(r(),i("div",ce,[...s[1]||(s[1]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-white mx-auto mb-2"},null,-1),e("p",{class:"text-blue-200"},"Loading matches...",-1)])])):l.value?v.value.length?(r(),i("div",be,[(r(!0),i(T,null,N(v.value,t=>(r(),j(a,{key:t.id,to:{name:"match-center",params:{id:t.id}},class:"block bg-white/5 hover:bg-white/10 rounded-lg p-4 border border-white/10 transition-colors cursor-pointer"},{default:g(()=>[e("div",me,[e("div",xe,[e("span",fe,n(b(t.team_a))+" vs "+n(b(t.team_b)),1),e("span",{class:h(["px-3 py-1 rounded-full text-xs font-semibold",F(t.status)])},n(t.status),3)]),e("div",pe,[e("div",null,"ðŸ“… "+n(A(t)),1),e("div",null,"ðŸ•’ "+n(I(t)),1)])]),e("div",ge,[e("div",he,n(t.score_a)+" - "+n(t.score_b),1),e("div",ve,[t.time_left&&t.status==="active"?(r(),i("div",we," â±ï¸ "+n(P(t.time_left))+" remaining ",1)):p("",!0),t.tournament_id||t.division_id?(r(),i("div",ye," ðŸ† Tournament Match ")):p("",!0)])])]),_:2},1032,["to"]))),128))])):(r(),i("div",_e,[...s[3]||(s[3]=[e("div",{class:"text-6xl mb-4"},"ðŸ“Š",-1),e("p",{class:"text-xl text-white mb-2"},"No Upcoming Matches",-1),e("p",{class:"text-blue-200"},"Your team doesn't have any scheduled matches at the moment",-1)])])):(r(),i("div",ue,[...s[2]||(s[2]=[e("div",{class:"text-6xl mb-4"},"ðŸ‘¥",-1),e("p",{class:"text-xl text-white mb-2"},"No Team Assigned",-1),e("p",{class:"text-blue-200"},"Contact an administrator to be assigned to a team",-1)])]))]),e("div",ke,[s[5]||(s[5]=e("h2",{class:"text-2xl font-bold text-white mb-6"},"ðŸ“ˆ Recent Results",-1)),w.value.length===0?(r(),i("div",Se,[...s[4]||(s[4]=[e("div",{class:"text-4xl mb-4"},"ðŸ“",-1),e("p",{class:"text-blue-200"},"No recent matches to display",-1)])])):(r(),i("div",Me,[(r(!0),i(T,null,N(w.value,t=>(r(),j(a,{key:t.id,to:{name:"match-center",params:{id:t.id}},class:"block bg-white/5 hover:bg-white/10 rounded-lg p-3 border border-white/10 transition-colors cursor-pointer"},{default:g(()=>[e("div",De,[e("div",Te,[e("span",Ne,n(b(t.team_a))+" vs "+n(b(t.team_b)),1),e("span",Le,n(t.score_a)+" - "+n(t.score_b),1),e("span",{class:h(["px-2 py-1 rounded text-xs font-semibold",Y(t,l.value?.id)])},n(U(t,l.value?.id)),3)]),e("div",Ue,n(A(t)),1)])]),_:2},1032,["to"]))),128))]))])]),e("div",Ae,[e("div",Re,[s[8]||(s[8]=e("h2",{class:"text-2xl font-bold text-white mb-6"},"ðŸ† Tournament Standings",-1)),L.value?(r(),i("div",Ce,[...s[6]||(s[6]=[e("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-white mx-auto mb-2"},null,-1),e("p",{class:"text-blue-200 text-sm"},"Loading standings...",-1)])])):y.value.length===0?(r(),i("div",Ee,[...s[7]||(s[7]=[e("div",{class:"text-4xl mb-4"},"ðŸ“Š",-1),e("p",{class:"text-blue-200"},"No tournament data available",-1)])])):(r(),i("div",$e,[(r(!0),i(T,null,N(y.value,(t,d)=>(r(),i("div",{key:t.id,class:h(["flex justify-between items-center p-3 rounded-lg",t.id===l.value?.id?"bg-blue-600/30 border border-blue-400":"bg-white/5"])},[e("div",je,[e("span",qe,n(d+1)+".",1),e("span",{class:h(["text-white",{"font-bold":t.id===l.value?.id}])},n(t.name),3),t.id===l.value?.id?(r(),i("span",Be," YOUR TEAM ")):p("",!0)]),e("div",We,[e("div",Ve,n(t.points||0)+" pts",1),e("div",Oe,n(t.wins||0)+"W "+n(t.losses||0)+"L",1)])],2))),128))]))]),s[9]||(s[9]=e("div",{class:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20"},null,-1))])]),e("div",Fe,[$(a,{to:"/scoreboard",class:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors flex items-center space-x-2"},{default:g(()=>[...s[10]||(s[10]=[e("span",null,"ðŸ“º",-1),e("span",null,"Live Scoreboard",-1)])]),_:1}),$(a,{to:"/profile",class:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-medium transition-colors flex items-center space-x-2"},{default:g(()=>[...s[11]||(s[11]=[e("span",null,"ðŸ‘¤",-1),e("span",null,"My Profile",-1)])]),_:1})])])])}}}),Ge=H(Ye,[["__scopeId","data-v-6d4ea7d1"]]);export{Ge as default};
