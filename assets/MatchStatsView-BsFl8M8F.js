import{e as H,B as J,r as v,a as m,p as K,o as O,g as d,i as t,t as s,u as w,l as c,n as A,j as C,I as E,E as Q,F as W,k as X,q as Y,h as r}from"./vendor-BHPTlv71.js";import{s as M,_ as Z}from"./index-BEMb2HgI.js";import{a as j,f as tt}from"./timeline-C-9ia41o.js";const et={class:"min-h-screen bg-base-200 p-4"},st={key:0,class:"text-center py-16"},at={class:"mt-4"},ot={key:1,class:"max-w-6xl mx-auto"},lt={class:"flex justify-between items-center mb-6"},nt={class:"text-sm opacity-70"},it={class:"text-right"},dt={class:"text-4xl font-bold"},rt={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},ct={class:"card bg-blue-100 shadow-lg"},ut={class:"card-body"},mt={class:"card-title text-blue-800"},vt={class:"space-y-2"},pt={class:"flex justify-between"},_t={class:"font-bold"},ft={class:"flex justify-between"},bt={class:"font-bold"},yt={class:"flex justify-between"},ht={class:"font-bold"},gt={class:"flex justify-between"},xt={class:"font-bold"},wt={key:0,class:"mr-1"},Bt={key:1,class:"mr-1"},Tt={key:2},kt={key:3},At={class:"card bg-purple-100 shadow-lg"},Ct={class:"card-body"},Et={class:"space-y-2"},Mt={class:"flex justify-between"},jt={class:"font-bold"},St={class:"flex justify-between"},Pt={class:"font-bold"},Dt={class:"flex justify-between"},Gt={class:"font-bold"},It={class:"flex justify-between"},Vt={class:"font-bold"},Nt={class:"card bg-orange-100 shadow-lg"},Ut={class:"card-body"},$t={class:"card-title text-orange-800"},Ft={class:"space-y-2"},Lt={class:"flex justify-between"},qt={class:"font-bold"},Rt={class:"flex justify-between"},zt={class:"font-bold"},Ht={class:"flex justify-between"},Jt={class:"font-bold"},Kt={class:"flex justify-between"},Ot={class:"font-bold"},Qt={key:0,class:"mr-1"},Wt={key:1,class:"mr-1"},Xt={key:2},Yt={key:3},Zt={class:"card bg-base-100 shadow-lg mb-6"},te={class:"card-body"},ee={class:"flex flex-wrap gap-4"},se={class:"form-control"},ae={class:"form-control"},oe={value:"a"},le={value:"b"},ne={class:"card bg-base-100 shadow-lg"},ie={class:"card-body"},de={key:0,class:"text-center py-8 text-base-content/50"},re={key:1,class:"space-y-3"},ce={class:"flex items-start gap-3"},ue={class:"text-3xl"},me={class:"flex-1"},ve={class:"flex justify-between items-start"},pe={class:"font-medium"},_e={class:"text-xs opacity-70"},fe={key:0,class:"mt-2 text-sm opacity-80"},be={key:1,class:"mt-2 text-sm opacity-80"},ye={key:2,class:"mt-2 text-sm opacity-80"},he={key:2,class:"text-center py-16"},ge=H({__name:"MatchStatsView",setup(xe){const S=K(),B=Y(),{t:P}=J(),l=v(null),g=v({}),x=v(!0),p=v("all"),_=v("all"),T=m(()=>S.params.id),f=m(()=>l.value?g.value[l.value.team_a]:null),b=m(()=>l.value?g.value[l.value.team_b]:null),D=m(()=>l.value?.timeline?[...l.value.timeline].sort((a,e)=>new Date(e.timestamp).getTime()-new Date(a.timestamp).getTime()):[]),k=m(()=>{let a=D.value;return p.value!=="all"&&(a=a.filter(e=>e.type===p.value)),_.value!=="all"&&(a=a.filter(e=>e.team===_.value)),a}),n=m(()=>{if(!l.value?.timeline)return null;const a=j(l.value.timeline,"a"),e=j(l.value.timeline,"b"),i=a.filter(o=>o.type==="goal").length,u=e.filter(o=>o.type==="goal").length,F=a.filter(o=>o.type==="penalty_corner").length,L=e.filter(o=>o.type==="penalty_corner").length,q=a.filter(o=>o.type==="booster_activated").length,R=e.filter(o=>o.type==="booster_activated").length,y=a.filter(o=>o.type==="card_issued"),h=e.filter(o=>o.type==="card_issued"),z=l.value.timeline.filter(o=>o.type==="maddie_activated").length;return{teamA:{goals:i,pcs:F,boosters:q,cards:{yellow:y.filter(o=>o.details.card_type==="yellow").length,green:y.filter(o=>o.details.card_type==="green").length,red:y.filter(o=>o.details.card_type==="red").length,total:y.length}},teamB:{goals:u,pcs:L,boosters:R,cards:{yellow:h.filter(o=>o.details.card_type==="yellow").length,green:h.filter(o=>o.details.card_type==="green").length,red:h.filter(o=>o.details.card_type==="red").length,total:h.length}},maddies:z,totalEvents:l.value.timeline.length}});function G(a){switch(a.type){case"goal":return"âš½";case"penalty_corner":return"ðŸ’";case"booster_activated":return a.details.booster_icon||"âš¡";case"maddie_activated":return a.details.maddie_icon||"ðŸŽª";case"card_issued":const e=a.details.card_type;return e==="yellow"?"ðŸŸ¨":e==="green"?"ðŸŸ©":"ðŸŸ¥";case"match_started":return"â–¶ï¸";case"match_paused":return"â¸ï¸";case"match_resumed":return"â–¶ï¸";case"match_finished":return"ðŸ";default:return"ðŸ“"}}function I(a){return a.team==="a"?"border-l-4 border-blue-500 bg-blue-50":a.team==="b"?"border-l-4 border-orange-500 bg-orange-50":"border-l-4 border-purple-500 bg-purple-50"}function V(a){return new Date(a).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}async function N(){try{const{data:a,error:e}=await M.from("matches").select("*").eq("id",T.value).single();if(e){console.error("Error loading match:",e);return}l.value=a}catch(a){console.error("Error loading match:",a)}}async function U(){try{const{data:a,error:e}=await M.from("teams").select("*");if(e){console.error("Error loading teams:",e);return}const i={};a?.forEach(u=>{i[u.id]=u}),g.value=i}catch(a){console.error("Error loading teams:",a)}}function $(){B.push(`/match-control/${T.value}`)}return O(async()=>{x.value=!0,await Promise.all([N(),U()]),x.value=!1}),(a,e)=>(r(),d("div",et,[x.value?(r(),d("div",st,[e[3]||(e[3]=t("span",{class:"loading loading-spinner loading-lg"},null,-1)),t("p",at,s(w(P)("loading")),1)])):l.value?(r(),d("div",ot,[t("div",lt,[t("div",null,[t("button",{onClick:$,class:"btn btn-ghost btn-sm mb-2"}," â† Back to Match Control "),e[4]||(e[4]=t("h1",{class:"text-3xl font-bold"},"Match Statistics & Timeline",-1)),t("p",nt,s(f.value?.name||"Team A")+" vs "+s(b.value?.name||"Team B"),1)]),t("div",it,[t("div",dt,s(l.value.score_a)+" - "+s(l.value.score_b),1),t("div",{class:A(["badge",{"badge-success":l.value.status==="active","badge-warning":l.value.status==="paused","badge-info":l.value.status==="pending","badge-neutral":l.value.status==="finished"}])},s(l.value.status.toUpperCase()),3)])]),n.value?(r(),d("div",rt,[t("div",ct,[t("div",ut,[t("h3",mt,s(f.value?.name||"Team A"),1),t("div",vt,[t("div",pt,[e[5]||(e[5]=t("span",null,"âš½ Goals:",-1)),t("span",_t,s(n.value.teamA.goals),1)]),t("div",ft,[e[6]||(e[6]=t("span",null,"ðŸ’ Penalty Corners:",-1)),t("span",bt,s(n.value.teamA.pcs),1)]),t("div",yt,[e[7]||(e[7]=t("span",null,"âš¡ Boosters Used:",-1)),t("span",ht,s(n.value.teamA.boosters),1)]),t("div",gt,[e[8]||(e[8]=t("span",null,"Cards:",-1)),t("span",xt,[n.value.teamA.cards.yellow?(r(),d("span",wt,"ðŸŸ¨"+s(n.value.teamA.cards.yellow),1)):c("",!0),n.value.teamA.cards.green?(r(),d("span",Bt,"ðŸŸ©"+s(n.value.teamA.cards.green),1)):c("",!0),n.value.teamA.cards.red?(r(),d("span",Tt,"ðŸŸ¥"+s(n.value.teamA.cards.red),1)):c("",!0),n.value.teamA.cards.total?c("",!0):(r(),d("span",kt,"None"))])])])])]),t("div",At,[t("div",Ct,[e[13]||(e[13]=t("h3",{class:"card-title text-purple-800"},"Match Stats",-1)),t("div",Et,[t("div",Mt,[e[9]||(e[9]=t("span",null,"ðŸŽª Maddies:",-1)),t("span",jt,s(n.value.maddies),1)]),t("div",St,[e[10]||(e[10]=t("span",null,"ðŸ“Š Total Events:",-1)),t("span",Pt,s(n.value.totalEvents),1)]),t("div",Dt,[e[11]||(e[11]=t("span",null,"ðŸ“ Current Score:",-1)),t("span",Gt,s(l.value.score_a)+" - "+s(l.value.score_b),1)]),t("div",It,[e[12]||(e[12]=t("span",null,"â±ï¸ Time Left:",-1)),t("span",Vt,s(Math.floor(l.value.time_left/60))+":"+s(String(l.value.time_left%60).padStart(2,"0")),1)])])])]),t("div",Nt,[t("div",Ut,[t("h3",$t,s(b.value?.name||"Team B"),1),t("div",Ft,[t("div",Lt,[e[14]||(e[14]=t("span",null,"âš½ Goals:",-1)),t("span",qt,s(n.value.teamB.goals),1)]),t("div",Rt,[e[15]||(e[15]=t("span",null,"ðŸ’ Penalty Corners:",-1)),t("span",zt,s(n.value.teamB.pcs),1)]),t("div",Ht,[e[16]||(e[16]=t("span",null,"âš¡ Boosters Used:",-1)),t("span",Jt,s(n.value.teamB.boosters),1)]),t("div",Kt,[e[17]||(e[17]=t("span",null,"Cards:",-1)),t("span",Ot,[n.value.teamB.cards.yellow?(r(),d("span",Qt,"ðŸŸ¨"+s(n.value.teamB.cards.yellow),1)):c("",!0),n.value.teamB.cards.green?(r(),d("span",Wt,"ðŸŸ©"+s(n.value.teamB.cards.green),1)):c("",!0),n.value.teamB.cards.red?(r(),d("span",Xt,"ðŸŸ¥"+s(n.value.teamB.cards.red),1)):c("",!0),n.value.teamB.cards.total?c("",!0):(r(),d("span",Yt,"None"))])])])])])])):c("",!0),t("div",Zt,[t("div",te,[e[22]||(e[22]=t("h3",{class:"card-title mb-4"},"Filters",-1)),t("div",ee,[t("div",se,[e[19]||(e[19]=t("label",{class:"label"},[t("span",{class:"label-text"},"Event Type")],-1)),C(t("select",{"onUpdate:modelValue":e[0]||(e[0]=i=>p.value=i),class:"select select-bordered"},[...e[18]||(e[18]=[Q('<option value="all" data-v-0e318a4f>All Events</option><option value="goal" data-v-0e318a4f>Goals</option><option value="penalty_corner" data-v-0e318a4f>Penalty Corners</option><option value="booster_activated" data-v-0e318a4f>Boosters</option><option value="maddie_activated" data-v-0e318a4f>Maddies</option><option value="card_issued" data-v-0e318a4f>Cards</option><option value="match_started" data-v-0e318a4f>Match Started</option><option value="match_paused" data-v-0e318a4f>Match Paused</option><option value="match_finished" data-v-0e318a4f>Match Finished</option>',9)])],512),[[E,p.value]])]),t("div",ae,[e[21]||(e[21]=t("label",{class:"label"},[t("span",{class:"label-text"},"Team")],-1)),C(t("select",{"onUpdate:modelValue":e[1]||(e[1]=i=>_.value=i),class:"select select-bordered"},[e[20]||(e[20]=t("option",{value:"all"},"All Teams",-1)),t("option",oe,s(f.value?.name||"Team A"),1),t("option",le,s(b.value?.name||"Team B"),1)],512),[[E,_.value]])])])])]),t("div",ne,[t("div",ie,[e[23]||(e[23]=t("h3",{class:"card-title mb-4"},"Match Timeline",-1)),k.value.length===0?(r(),d("div",de," No events to display ")):(r(),d("div",re,[(r(!0),d(W,null,X(k.value,(i,u)=>(r(),d("div",{key:u,class:A(["p-4 rounded-lg transition-all hover:shadow-md",I(i)])},[t("div",ce,[t("div",ue,s(G(i)),1),t("div",me,[t("div",ve,[t("p",pe,s(w(tt)(i,f.value?.name||"Team A",b.value?.name||"Team B")),1),t("span",_e,s(V(i.timestamp)),1)]),i.type==="booster_activated"?(r(),d("div",fe," Duration: "+s(i.details.duration?`${i.details.duration} min`:"Instant"),1)):c("",!0),i.type==="maddie_activated"?(r(),d("div",be," Duration: "+s(i.details.duration?`${i.details.duration} min`:"Instant"),1)):c("",!0),i.type==="card_issued"?(r(),d("div",ye," Penalty: "+s(i.details.duration==="never"?"Game":`${i.details.duration/60} min`),1)):c("",!0)])])],2))),128))]))])])])):(r(),d("div",he,[e[24]||(e[24]=t("p",{class:"text-xl"},"Match not found",-1)),t("button",{onClick:e[2]||(e[2]=i=>w(B).push("/admin")),class:"btn btn-primary mt-4"}," Go to Admin Panel ")]))]))}}),ke=Z(ge,[["__scopeId","data-v-0e318a4f"]]);export{ke as default};
