import{e as E,r as u,a as V,o as D,g as a,i as s,E as L,z as e,t as l,l as d,n as k,u as b,j as S,G as C,x as T,y as _,s as P,h as r}from"./vendor-BHPTlv71.js";import{u as N,s as y}from"./index-BEMb2HgI.js";const I={class:"min-h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-indigo-900 p-8"},R={class:"container mx-auto max-w-4xl"},U={class:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20"},B={class:"mb-6"},H={class:"bg-black/20 rounded-lg p-4 space-y-2 font-mono text-sm"},j={class:"text-green-300"},z={class:"text-green-300"},F={class:"text-yellow-300"},M={class:"mb-6"},O=["disabled"],q={key:0,class:"bg-black/20 rounded-lg p-4 font-mono text-sm"},G={key:0,class:"text-red-300 mt-2"},K={key:1,class:"text-blue-300 mt-2"},Q={class:"mb-6"},W={class:"bg-black/20 rounded-lg p-4 space-y-2 font-mono text-sm"},$={class:"text-blue-300"},J={class:"text-blue-300"},X={class:"text-blue-300"},Y={class:"text-blue-300"},Z={class:"text-blue-300"},tt={class:"mb-6"},st={class:"grid md:grid-cols-2 gap-4"},et=["disabled"],lt={key:0,class:"bg-black/20 rounded-lg p-4 font-mono text-sm mt-3"},ot={key:0,class:"text-red-300 mt-2"},nt={key:1,class:"text-blue-300 mt-2"},it={class:"flex space-x-4"},dt=E({__name:"AuthDiagnosticView",setup(at){const c=N(),m=u(!1),n=u(null),v=u(!1),i=u(null),g=u("admin@test.com"),p=u("password"),x=V(()=>({url:"https://hfwehsnejieymucgcaem.supabase.co",keyPreview:"sb_publishable_OLUCI5DEEP1Q1798SHbHqw_yu2V1aTD".substring(0,20)+"...",source:"Environment Variable"}));async function w(){m.value=!0,n.value=null;try{console.log("üîß Testing Supabase connection...");const{data:o,error:t}=await y.from("teams").select("count").limit(1);if(t)throw t;n.value={success:!0,details:"Successfully connected to Supabase database"}}catch(o){console.error("üîß Connection test failed:",o),n.value={success:!1,error:o.message||"Connection failed",details:o.hint||"Check if Supabase is running on localhost:54321"}}finally{m.value=!1}}async function A(){v.value=!0,i.value=null;try{console.log("üîß Testing authentication...");const{data:o,error:t}=await y.auth.signInWithPassword({email:g.value,password:p.value});if(t)throw t;i.value={success:!0,details:`Successfully authenticated user: ${o.user?.email}`},setTimeout(()=>{y.auth.signOut()},2e3)}catch(o){console.error("üîß Auth test failed:",o),i.value={success:!1,error:o.message||"Authentication failed",details:"Check if user exists in database or Supabase auth is properly configured"}}finally{v.value=!1}}return D(()=>{w()}),(o,t)=>{const h=P("RouterLink");return r(),a("div",I,[s("div",R,[s("div",U,[t[24]||(t[24]=s("h1",{class:"text-3xl font-bold text-white mb-6"},"üîß Authentication Diagnostic",-1)),s("div",B,[t[5]||(t[5]=s("h2",{class:"text-xl font-semibold text-white mb-3"},"üåç Environment Configuration",-1)),s("div",H,[s("div",j,[t[2]||(t[2]=s("strong",null,"Supabase URL:",-1)),e(" "+l(x.value.url),1)]),s("div",z,[t[3]||(t[3]=s("strong",null,"Anon Key Preview:",-1)),e(" "+l(x.value.keyPreview),1)]),s("div",F,[t[4]||(t[4]=s("strong",null,"Source:",-1)),e(" "+l(x.value.source),1)])])]),s("div",M,[t[9]||(t[9]=s("h2",{class:"text-xl font-semibold text-white mb-3"},"üîå Connection Test",-1)),s("button",{onClick:w,disabled:m.value,class:"btn btn-primary mb-3"},l(m.value?"Testing...":"Test Supabase Connection"),9,O),n.value?(r(),a("div",q,[s("div",{class:k(n.value.success?"text-green-300":"text-red-300")},[t[6]||(t[6]=s("strong",null,"Status:",-1)),e(" "+l(n.value.success?"‚úÖ Connected":"‚ùå Connection Failed"),1)],2),n.value.error?(r(),a("div",G,[t[7]||(t[7]=s("strong",null,"Error:",-1)),e(" "+l(n.value.error),1)])):d("",!0),n.value.details?(r(),a("div",K,[t[8]||(t[8]=s("strong",null,"Details:",-1)),e(" "+l(n.value.details),1)])):d("",!0)])):d("",!0)]),s("div",Q,[t[15]||(t[15]=s("h2",{class:"text-xl font-semibold text-white mb-3"},"üîê Auth Store Status",-1)),s("div",W,[s("div",$,[t[10]||(t[10]=s("strong",null,"Loading:",-1)),e(" "+l(b(c).loading),1)]),s("div",J,[t[11]||(t[11]=s("strong",null,"Is Authenticated:",-1)),e(" "+l(b(c).isAuthenticated),1)]),s("div",X,[t[12]||(t[12]=s("strong",null,"Is Admin:",-1)),e(" "+l(b(c).isAdmin),1)]),s("div",Y,[t[13]||(t[13]=s("strong",null,"User ID:",-1)),e(" "+l(b(c).user?.id||"None"),1)]),s("div",Z,[t[14]||(t[14]=s("strong",null,"Profile Email:",-1)),e(" "+l(b(c).profile?.email||"None"),1)])])]),s("div",tt,[t[21]||(t[21]=s("h2",{class:"text-xl font-semibold text-white mb-3"},"üß™ Test Authentication",-1)),s("div",st,[s("div",null,[t[16]||(t[16]=s("label",{class:"block text-white mb-2"},"Test Email:",-1)),S(s("input",{"onUpdate:modelValue":t[0]||(t[0]=f=>g.value=f),type:"email",placeholder:"admin@test.com",class:"input w-full"},null,512),[[C,g.value]])]),s("div",null,[t[17]||(t[17]=s("label",{class:"block text-white mb-2"},"Test Password:",-1)),S(s("input",{"onUpdate:modelValue":t[1]||(t[1]=f=>p.value=f),type:"password",placeholder:"password",class:"input w-full"},null,512),[[C,p.value]])])]),s("button",{onClick:A,disabled:v.value,class:"btn btn-primary mt-3"},l(v.value?"Testing...":"Test Login"),9,et),i.value?(r(),a("div",lt,[s("div",{class:k(i.value.success?"text-green-300":"text-red-300")},[t[18]||(t[18]=s("strong",null,"Status:",-1)),e(" "+l(i.value.success?"‚úÖ Login Successful":"‚ùå Login Failed"),1)],2),i.value.error?(r(),a("div",ot,[t[19]||(t[19]=s("strong",null,"Error:",-1)),e(" "+l(i.value.error),1)])):d("",!0),i.value.details?(r(),a("div",nt,[t[20]||(t[20]=s("strong",null,"Details:",-1)),e(" "+l(i.value.details),1)])):d("",!0)])):d("",!0)]),t[25]||(t[25]=L('<div class="mb-6"><h2 class="text-xl font-semibold text-white mb-3">üìã Troubleshooting Steps</h2><div class="bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-4"><ol class="text-yellow-100 space-y-2 list-decimal list-inside"><li>Ensure Supabase is running: <code class="bg-black/20 px-2 py-1 rounded">npx supabase start</code></li><li>Check if port 54321 is available</li><li>Verify database migrations are applied: <code class="bg-black/20 px-2 py-1 rounded">npx supabase db reset</code></li><li>Check if admin user exists in users table</li><li>Try restarting both Supabase and the frontend server</li></ol></div></div>',1)),s("div",it,[T(h,{to:"/",class:"btn btn-secondary"},{default:_(()=>[...t[22]||(t[22]=[e(" ‚Üê Back to Home ",-1)])]),_:1}),T(h,{to:"/login",class:"btn btn-primary"},{default:_(()=>[...t[23]||(t[23]=[e(" ‚Üí Try Login Again ",-1)])]),_:1})])])])])}}});export{dt as default};
