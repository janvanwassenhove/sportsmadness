import{e as x,r as u,g as m,i as t,t as a,P as L,l as v,j as b,G as f,x as k,y as $,s as S,z as V,q,p as C,h as g}from"./vendor-BHPTlv71.js";import{u as P}from"./index-BEMb2HgI.js";const R={class:"min-h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-indigo-900 flex items-center justify-center px-4"},U={class:"bg-white/10 backdrop-blur-sm rounded-xl p-8 w-full max-w-md border border-white/20"},N={class:"text-center mb-8"},T={class:"text-3xl font-bold text-white mb-2"},B={class:"text-blue-100"},E={for:"email",class:"block text-sm font-medium text-white mb-2"},I={for:"password",class:"block text-sm font-medium text-white mb-2"},M=["placeholder"],j={key:0,class:"bg-red-500/20 border border-red-500/50 rounded-lg p-3"},D={class:"text-red-100 text-sm"},H={key:1,class:"bg-green-500/20 border border-green-500/50 rounded-lg p-3"},z={class:"text-green-100 text-sm"},F=["disabled"],G={key:0},W={key:1},Y={class:"text-center"},J={class:"text-center"},X=x({__name:"LoginView",setup(K){const w=q(),_=C(),n=P(),c=u(""),l=u(""),p=u(!1),i=u(""),d=u(""),o=u(!1);async function A(){if(!c.value||!l.value){i.value="Email and password are required";return}p.value=!0,i.value="",d.value="";try{console.log("ğŸ” Login form: Starting authentication process");const e=o.value?await n.signUp(c.value,l.value):await n.signIn(c.value,l.value);if(console.log("ğŸ” Login form: Auth result:",e),e.error){console.error("ğŸ” Login form: Auth error:",e.error),i.value=e.error;return}if(o.value){d.value="Account created successfully! You can now sign in.",o.value=!1,l.value="";return}console.log("ğŸ” Login form: Login successful, checking auth state"),console.log("ğŸ” Login form: isAuthenticated:",n.isAuthenticated),console.log("ğŸ” Login form: isAdmin:",n.isAdmin);let r=0;for(;!n.isAuthenticated&&r<20;)await new Promise(h=>setTimeout(h,100)),r++;if(!n.isAuthenticated){console.error("ğŸ” Login form: Auth state did not update after sign in"),i.value="Authentication state error. Please try again.";return}console.log("ğŸ” Login form: Auth state confirmed after",r,"attempts"),console.log("ğŸ” Login form: Final state - isAuthenticated:",n.isAuthenticated,"isAdmin:",n.isAdmin);let s=_.query.redirect;s&&s.startsWith("/?/")&&(s=s.substring(2)),s||(s="/"),console.log("ğŸ” Login form: Redirecting to:",s),await w.push(s)}catch(e){console.error("ğŸ” Login form: Exception:",e),i.value=e.message||"An error occurred"}finally{p.value=!1}}function y(){o.value=!o.value,i.value="",d.value=""}return(e,r)=>{const s=S("RouterLink");return g(),m("div",R,[t("div",U,[t("div",N,[t("h1",T,a(o.value?e.$t("auth.createAccount"):e.$t("auth.adminLogin")),1),t("p",B,a(o.value?e.$t("auth.signUpSubtitle"):e.$t("auth.loginSubtitle")),1)]),t("form",{onSubmit:L(A,["prevent"]),class:"space-y-6"},[t("div",null,[t("label",E,a(e.$t("auth.email")),1),b(t("input",{id:"email","onUpdate:modelValue":r[0]||(r[0]=h=>c.value=h),type:"email",required:"",class:"input bg-white/10 text-white placeholder-blue-200 border-white/20",placeholder:"admin@hockeymadness.com"},null,512),[[f,c.value]])]),t("div",null,[t("label",I,a(e.$t("auth.password")),1),b(t("input",{id:"password","onUpdate:modelValue":r[1]||(r[1]=h=>l.value=h),type:"password",required:"",class:"input bg-white/10 text-white placeholder-blue-200 border-white/20",placeholder:e.$t("auth.enterPassword")},null,8,M),[[f,l.value]])]),i.value?(g(),m("div",j,[t("p",D,a(i.value),1)])):v("",!0),d.value?(g(),m("div",H,[t("p",z,a(d.value),1)])):v("",!0),t("button",{type:"submit",disabled:p.value,class:"w-full btn btn-primary disabled:opacity-50 disabled:cursor-not-allowed"},[p.value?(g(),m("span",G,a(o.value?e.$t("auth.creatingAccount"):e.$t("auth.signingIn")),1)):(g(),m("span",W,a(o.value?e.$t("auth.createAccount"):e.$t("auth.signIn")),1))],8,F),t("div",Y,[t("button",{type:"button",onClick:y,class:"text-blue-200 hover:text-white transition-colors"},a(o.value?e.$t("auth.alreadyHaveAccount"):e.$t("auth.needAccount")),1)]),t("div",J,[k(s,{to:"/",class:"text-blue-200 hover:text-white transition-colors text-sm"},{default:$(()=>[V(a(e.$t("auth.backToHome")),1)]),_:1})])],32)])])}}});export{X as default};
